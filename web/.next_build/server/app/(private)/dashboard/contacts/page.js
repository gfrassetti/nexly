(()=>{var e={};e.id=594,e.ids=[594],e.modules={20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},209:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},79348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},18426:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c});var a=r(3003),s=r(14293),n=r(66550),o=r.n(n),i=r(86979),l={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);r.d(t,l);let c=["",{children:["(private)",{children:["dashboard",{children:["contacts",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,82597)),"C:\\Users\\Guido\\Desktop\\Guido\\Nexly\\web\\src\\app\\(private)\\dashboard\\contacts\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,77173)),"C:\\Users\\Guido\\Desktop\\Guido\\Nexly\\web\\src\\app\\(private)\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,1338)),"C:\\Users\\Guido\\Desktop\\Guido\\Nexly\\web\\src\\app\\(private)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,52075,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,37973)),"C:\\Users\\Guido\\Desktop\\Guido\\Nexly\\web\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,52075,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["C:\\Users\\Guido\\Desktop\\Guido\\Nexly\\web\\src\\app\\(private)\\dashboard\\contacts\\page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/(private)/dashboard/contacts/page",pathname:"/dashboard/contacts",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},56880:(e,t,r)=>{Promise.resolve().then(r.bind(r,52177))},52177:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Y});var a=r(68819),s=r(17266),n=r(58838),o=r(74131);let i=async(e,t)=>{let r=await fetch(`https://nexly-production.up.railway.app${e}`,{headers:{Authorization:`Bearer ${t}`}});if(!r.ok)throw Error(`Error ${r.status}: ${r.statusText}`);return r.json()};var l=r(99890),c=r(38227),d=r(93095),u=r(48051),m=r(8473),p=r(82561),x=r(34214),h="AlertDialog",[g,f]=(0,d.b)(h,[m.p8]),v=(0,m.p8)(),b=e=>{let{__scopeAlertDialog:t,...r}=e,s=v(t);return(0,a.jsx)(m.fC,{...s,...r,modal:!0})};b.displayName=h;var y=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...s}=e,n=v(r);return(0,a.jsx)(m.xz,{...n,...s,ref:t})});y.displayName="AlertDialogTrigger";var j=e=>{let{__scopeAlertDialog:t,...r}=e,s=v(t);return(0,a.jsx)(m.h_,{...s,...r})};j.displayName="AlertDialogPortal";var w=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...s}=e,n=v(r);return(0,a.jsx)(m.aV,{...n,...s,ref:t})});w.displayName="AlertDialogOverlay";var N="AlertDialogContent",[k,C]=g(N),A=(0,x.sA)("AlertDialogContent"),D=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,children:n,...o}=e,i=v(r),l=s.useRef(null),c=(0,u.e)(t,l),d=s.useRef(null);return(0,a.jsx)(m.jm,{contentName:N,titleName:P,docsSlug:"alert-dialog",children:(0,a.jsx)(k,{scope:r,cancelRef:d,children:(0,a.jsxs)(m.VY,{role:"alertdialog",...i,...o,ref:c,onOpenAutoFocus:(0,p.Mj)(o.onOpenAutoFocus,e=>{e.preventDefault(),d.current?.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,a.jsx)(A,{children:n}),(0,a.jsx)(G,{contentRef:l})]})})})});D.displayName=N;var P="AlertDialogTitle",M=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...s}=e,n=v(r);return(0,a.jsx)(m.Dx,{...n,...s,ref:t})});M.displayName=P;var $="AlertDialogDescription",z=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...s}=e,n=v(r);return(0,a.jsx)(m.dk,{...n,...s,ref:t})});z.displayName=$;var E=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...s}=e,n=v(r);return(0,a.jsx)(m.x8,{...n,...s,ref:t})});E.displayName="AlertDialogAction";var L="AlertDialogCancel",S=s.forwardRef((e,t)=>{let{__scopeAlertDialog:r,...s}=e,{cancelRef:n}=C(L,r),o=v(r),i=(0,u.e)(t,n);return(0,a.jsx)(m.x8,{...o,...s,ref:i})});S.displayName=L;var G=({contentRef:e})=>{let t=`\`${N}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${N}\` by passing a \`${$}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${N}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return s.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},R=r(51223),I=r(91664);let O=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)(w,{className:(0,R.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));O.displayName=w.displayName;let T=s.forwardRef(({className:e,...t},r)=>(0,a.jsxs)(j,{children:[(0,a.jsx)(O,{}),(0,a.jsx)(D,{ref:r,className:(0,R.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));T.displayName=D.displayName;let W=({className:e,...t})=>(0,a.jsx)("div",{className:(0,R.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...t});W.displayName="AlertDialogHeader";let B=({className:e,...t})=>(0,a.jsx)("div",{className:(0,R.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});B.displayName="AlertDialogFooter";let H=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)(M,{ref:r,className:(0,R.cn)("text-lg font-semibold",e),...t}));H.displayName=M.displayName;let _=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)(z,{ref:r,className:(0,R.cn)("text-sm text-muted-foreground",e),...t}));_.displayName=z.displayName;let F=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)(E,{ref:r,className:(0,R.cn)((0,I.d)(),e),...t}));F.displayName=E.displayName;let U=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)(S,{ref:r,className:(0,R.cn)((0,I.d)({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));function J({items:e,onArchive:t,onUnarchive:r,onMessage:s,isArchiving:n=null,loading:o=!1,showArchived:i=!1}){let l=e=>{switch(e){case"whatsapp":return(0,a.jsx)("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-accent-cream text-[10px] font-bold",children:"WA"})});case"telegram":return(0,a.jsx)("div",{className:"w-6 h-6 bg-blue-400 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-accent-cream text-[10px] font-bold",children:"TG"})});case"instagram":return(0,a.jsx)("div",{className:"w-6 h-6 bg-pink-500 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-accent-cream text-[10px] font-bold",children:"IG"})});case"messenger":return(0,a.jsx)("div",{className:"w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-accent-cream text-[10px] font-bold",children:"M"})});default:return(0,a.jsx)("div",{className:"w-6 h-6 bg-neutral-500 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-accent-cream text-[10px] font-bold",children:"?"})})}},d=e=>{if(!e)return null;let t=new Date(e),r=Math.floor((new Date().getTime()-t.getTime())/864e5);return 0===r?"Hoy":1===r?"Ayer":r<7?`Hace ${r} d\xedas`:r<30?`Hace ${Math.floor(r/7)} semanas`:t.toLocaleDateString("es-ES",{day:"numeric",month:"short"})},u=e=>e?e.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"?";return o?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from({length:6}).map((e,t)=>(0,a.jsxs)("div",{className:"bg-neutral-800 rounded-lg p-4 border border-neutral-700",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,a.jsx)(c.O,{className:"w-12 h-12 rounded-full"}),(0,a.jsx)(c.O,{className:"absolute -bottom-1 -right-1 w-6 h-6 rounded-full"})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-0 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,a.jsx)(c.O,{className:"h-4 w-24"}),(0,a.jsx)(c.O,{className:"h-3 w-12"})]}),(0,a.jsx)(c.O,{className:"h-3 w-20"}),(0,a.jsx)(c.O,{className:"h-3 w-32"}),(0,a.jsx)(c.O,{className:"h-3 w-28"})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-4 pt-3 border-t border-neutral-700",children:[(0,a.jsx)(c.O,{className:"h-8 w-20"}),(0,a.jsx)(c.O,{className:"h-8 w-16"})]})]},t))}):(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsx)("div",{className:"space-y-4",children:0===e.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("svg",{className:"w-16 h-16 mx-auto mb-4 text-neutral-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-neutral-400 mb-2",children:"No hay contactos a\xfan"}),(0,a.jsx)("p",{className:"text-neutral-500 mb-4",children:"Los contactos aparecer\xe1n autom\xe1ticamente cuando alguien te escriba por primera vez"}),(0,a.jsxs)("div",{className:"text-sm text-neutral-600 space-y-1",children:[(0,a.jsx)("p",{children:"\uD83D\uDCF1 WhatsApp: Cuando alguien te env\xede un mensaje"}),(0,a.jsx)("p",{children:"\uD83D\uDCF8 Instagram: Cuando recibas un DM"}),(0,a.jsx)("p",{children:"\uD83D\uDCAC Messenger: Cuando alguien te contacte"})]})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(e=>(console.log("Contact debug:",{id:e.id,name:e.name,isArchived:e.isArchived,showArchived:i}),(0,a.jsxs)("div",{className:`bg-neutral-800 rounded-lg p-4 border border-neutral-700 hover:border-green-600/30 transition-all cursor-pointer group ${e.isArchived&&!i?"hidden":""}`,children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsxs)("div",{className:"relative flex-shrink-0",children:[e.avatar||e.profilePicture?(0,a.jsx)("img",{src:e.avatar||e.profilePicture,alt:e.name||"Avatar",className:"w-12 h-12 rounded-full object-cover",onError:e=>{e.currentTarget.style.display="none";let t=e.currentTarget.nextElementSibling;t&&(t.style.display="flex")}}):null,(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-green-600 to-green-700 rounded-full flex items-center justify-center text-accent-cream font-semibold text-sm",style:{display:e.avatar||e.profilePicture?"none":"flex"},children:u(e.name)}),(0,a.jsx)("div",{className:"absolute -bottom-1 -right-1",children:l(e.provider)})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2 mb-1",children:[(0,a.jsx)("h4",{className:"font-medium text-accent-cream truncate",children:e.name||"Sin nombre"}),e.lastInteraction&&(0,a.jsx)("span",{className:"text-xs text-neutral-500 flex-shrink-0",children:d(e.lastInteraction)})]}),e.platformData?.telegramUsername&&(0,a.jsxs)("p",{className:"text-xs text-blue-400 mb-1",children:["@",e.platformData.telegramUsername]}),e.lastMessagePreview&&(0,a.jsx)("p",{className:"text-sm text-neutral-400 truncate mb-2",children:e.lastMessagePreview}),e.phone&&(0,a.jsxs)("p",{className:"text-xs text-neutral-500 flex items-center gap-1",children:[(0,a.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),e.phone]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-4 pt-3 border-t border-neutral-700 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,a.jsxs)("button",{onClick:t=>{t.stopPropagation(),s?s(e):window.location.href=`/dashboard/inbox?contact=${e.id}`},className:"text-green-500 hover:text-green-400 px-3 py-1.5 rounded-lg text-sm transition-colors flex items-center gap-2",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),"Mensaje"]}),i?(0,a.jsxs)(b,{children:[(0,a.jsx)(y,{asChild:!0,children:(0,a.jsxs)("button",{onClick:e=>e.stopPropagation(),disabled:n===e.id,className:"text-green-400 hover:text-green-300 disabled:text-neutral-600 disabled:cursor-not-allowed px-3 py-1.5 rounded-lg text-sm transition-colors flex items-center gap-2",title:"Recuperar contacto",children:[n===e.id?(0,a.jsxs)("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),"Recuperar"]})}),(0,a.jsxs)(T,{children:[(0,a.jsxs)(W,{children:[(0,a.jsx)(H,{children:"\uD83D\uDD04 Recuperar contacto"}),(0,a.jsxs)(_,{children:["El contacto"," ",(0,a.jsx)("strong",{children:e.name||e.phone||"este contacto"})," ","volver\xe1 a aparecer en la vista principal de contactos."]})]}),(0,a.jsxs)(B,{children:[(0,a.jsx)(U,{children:"Cancelar"}),(0,a.jsx)(F,{onClick:()=>r?.(e.id),className:"bg-green-500 hover:bg-green-600",children:"Recuperar"})]})]})]}):(0,a.jsxs)(b,{children:[(0,a.jsx)(y,{asChild:!0,children:(0,a.jsxs)("button",{onClick:e=>e.stopPropagation(),disabled:n===e.id,className:"text-orange-400 hover:text-orange-300 disabled:text-neutral-600 disabled:cursor-not-allowed px-3 py-1.5 rounded-lg text-sm transition-colors flex items-center gap-2",title:"Archivar contacto (se puede recuperar m\xe1s tarde)",children:[n===e.id?(0,a.jsxs)("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8l4 4-4 4m9-4H9m8 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Archivar"]})}),(0,a.jsxs)(T,{children:[(0,a.jsxs)(W,{children:[(0,a.jsx)(H,{children:"\uD83D\uDCE6 Archivar contacto"}),(0,a.jsxs)(_,{children:["El contacto"," ",(0,a.jsx)("strong",{children:e.name||e.phone||"este contacto"})," ","se ocultar\xe1 de la vista principal pero podr\xe1s recuperarlo m\xe1s tarde desde la secci\xf3n de contactos archivados."]})]}),(0,a.jsxs)(B,{children:[(0,a.jsx)(U,{children:"Cancelar"}),(0,a.jsx)(F,{onClick:()=>t(e.id),className:"bg-orange-500 hover:bg-orange-600",children:"Archivar"})]})]})]})]})]},e.id)))})})})}U.displayName=S.displayName;var q=r(40818),V=r(18069);let Z=[...r(53566).Du];function Y(){let{token:e}=(0,o.a)(),{refreshContacts:t}=(0,l.p)(),[r,c]=(0,s.useState)("telegram"),[d,u]=(0,s.useState)(""),[m,p]=(0,s.useState)(null),[x,h]=(0,s.useState)(!1),{showSuccess:g,showError:f}=(0,q.w)(),{syncAll:v,syncIntegration:b,isSyncing:y,syncProgress:j}=function(){let{token:e}=(0,o.a)(),{showSuccess:t,showError:r}=(0,q.w)(),[a,n]=(0,s.useState)(!1),[i,l]=(0,s.useState)(null);return{syncAll:async a=>{if(!e)return r("Error","No est\xe1s autenticado"),null;n(!0),l("Sincronizando contactos...");try{let s=await (0,V.x4)(e);if(!s.success)return r("Error",s.message||"Error al sincronizar contactos"),s;{let{totalSynced:e,totalCreated:r,totalUpdated:n}=s.summary||{totalSynced:0,totalCreated:0,totalUpdated:0};return t("Sincronizaci\xf3n completada",`${e} contactos sincronizados (${r} nuevos, ${n} actualizados)`),a&&a(),s}}catch(e){return r("Error",e?.response?.data?.message||e?.message||"Error al sincronizar contactos"),null}finally{n(!1),l(null)}},syncIntegration:async(a,s)=>{if(!e)return r("Error","No est\xe1s autenticado"),null;n(!0),l(`Sincronizando ${a}...`);try{let n=await (0,V.aS)(a,e);if(!n.success||!n.result)return r("Error",n.message||"Error al sincronizar integraci\xf3n"),n;{let{contactsSynced:e,contactsCreated:r,contactsUpdated:a,provider:o}=n.result;return t("Sincronizaci\xf3n completada",`${e} contactos de ${o} sincronizados (${r} nuevos, ${a} actualizados)`),s&&s(),n}}catch(e){return r("Error",e?.response?.data?.message||e?.message||"Error al sincronizar integraci\xf3n"),null}finally{n(!1),l(null)}},isSyncing:a,syncProgress:i}}(),{items:w,loading:N,error:k,refetch:C,refetchAll:A,counts:D}=function(e,t=!1,r=!1){let{token:a}=(0,o.a)(),l=new URLSearchParams;e&&l.set("integrationId",e),t&&l.set("archived","true");let c=a?`/contacts${l.toString()?`?${l.toString()}`:""}`:null,d=new URLSearchParams;e&&d.set("integrationId",e);let u=a&&r?`/contacts${d.toString()?`?${d.toString()}`:""}`:null,m=new URLSearchParams;e&&m.set("integrationId",e),m.set("archived","true");let p=a&&r?`/contacts?${m.toString()}`:null,{data:x,error:h,isLoading:g,mutate:f}=(0,n.ZP)(c,e=>i(e,a),{revalidateOnFocus:!1,revalidateOnReconnect:!0,dedupingInterval:3e4,refreshInterval:6e4,keepPreviousData:!0,fallbackData:[]}),{data:v,mutate:b}=(0,n.ZP)(u,e=>i(e,a),{revalidateOnFocus:!1,dedupingInterval:6e4,fallbackData:[]}),{data:y,mutate:j}=(0,n.ZP)(p,e=>i(e,a),{revalidateOnFocus:!1,dedupingInterval:6e4,fallbackData:[]}),w=(0,s.useMemo)(()=>{if(r)return{active:Array.isArray(v)?v.length:0,archived:Array.isArray(y)?y.length:0}},[r,v,y]),N=(0,s.useMemo)(()=>Array.isArray(x)?x:[],[x]),k=h?h.message||"No se pudieron cargar los contactos":null,C=async()=>{await Promise.all([f(),r?b():Promise.resolve(),r?j():Promise.resolve()])};return{items:N,loading:g,error:k,refetch:f,refetchAll:C,counts:w}}(r,x,!0);console.log("ContactsPage debug:",{integrationId:r,showArchived:x,contactsCount:w?.length||0,contacts:w?.slice(0,2),loading:N,error:k,counts:D});let P=(0,s.useMemo)(()=>{let e=Array.isArray(w)?w:[];return d.trim()?e.filter(e=>e.name?.toLowerCase().includes(d.toLowerCase())||e.phone?.toLowerCase().includes(d.toLowerCase())||e.email?.toLowerCase().includes(d.toLowerCase())):e},[w,d]),M=(e,t)=>{console.error(`Error en ${t}:`,e),f("Error",e?.response?.data?.message||e?.message||`Error en ${t}`)};async function $(r){if(!e){f("Error","No tienes permisos para realizar esta acci\xf3n");return}p(r);try{let a=await fetch(`https://nexly-production.up.railway.app/contacts/${r}/archive`,{method:"PATCH",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({archived:!0})});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(e.message||`Error ${a.status}: ${a.statusText}`)}let s=await a.json();g("Contacto archivado",s.message||"Contacto archivado exitosamente. Puedes recuperarlo m\xe1s tarde."),t(),await A()}catch(e){M(e,"archivar contacto")}finally{p(null)}}async function z(r){if(!e){f("Error","No tienes permisos para realizar esta acci\xf3n");return}p(r);try{let a=await fetch(`https://nexly-production.up.railway.app/contacts/${r}/archive`,{method:"PATCH",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({archived:!1})});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(e.message||`Error ${a.status}: ${a.statusText}`)}let s=await a.json();g("Contacto recuperado",s.message||"Contacto recuperado exitosamente."),t(),await A()}catch(e){M(e,"recuperar contacto")}finally{p(null)}}async function E(){await v(()=>{t(),C()})}async function L(e){await b(e,()=>{t(),C()})}return(0,a.jsxs)("div",{className:"h-full flex flex-col bg-accent-dark text-accent-cream",children:[(0,a.jsxs)("div",{className:"border-b border-neutral-700 bg-neutral-800 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-accent-cream",children:"Contactos"}),(0,a.jsx)("p",{className:"text-neutral-400 mt-1",children:"Gestiona tus contactos de todas las plataformas"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)("div",{className:"flex bg-neutral-700 rounded-lg p-1",children:[(0,a.jsxs)("button",{onClick:()=>h(!1),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${x?"text-neutral-300 hover:text-accent-cream":"bg-neutral-600 text-accent-cream"}`,children:["Activos (",D?.active||0,")"]}),(0,a.jsxs)("button",{onClick:()=>h(!0),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${x?"bg-neutral-600 text-accent-cream":"text-neutral-300 hover:text-accent-cream"}`,children:["\uD83D\uDCE6 Archivados (",D?.archived||0,")"]})]}),(0,a.jsx)("button",{onClick:E,disabled:y,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-800 disabled:cursor-not-allowed text-accent-cream px-4 py-2 rounded-lg flex items-center gap-2 transition-colors",children:y?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),j||"Sincronizando..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Sincronizar"]})}),(0,a.jsxs)("button",{onClick:()=>window.location.href="/dashboard/integrations",className:"bg-green-600 hover:bg-green-700 text-accent-cream px-4 py-2 rounded-lg flex items-center gap-2 transition-colors",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),"Conectar Apps"]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,a.jsx)("div",{className:"flex gap-2",children:Z.map(e=>(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsxs)("button",{onClick:()=>c(e.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors capitalize flex items-center gap-2 ${r===e.id?`${e.color} text-accent-cream shadow-lg`:"bg-neutral-700 text-neutral-300 hover:bg-neutral-600"}`,children:[(0,a.jsx)("div",{className:`w-2 h-2 rounded-full ${e.color}`}),e.label]}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),L(e.id)},disabled:y,className:"absolute -top-1 -right-1 w-5 h-5 bg-blue-500 hover:bg-blue-600 text-accent-cream rounded-full flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50",title:`Sincronizar ${e.label}`,children:y?(0,a.jsxs)("svg",{className:"w-3 h-3 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):(0,a.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]},e.id))}),(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)("input",{type:"text",placeholder:"Buscar contactos...",value:d,onChange:e=>u(e.target.value),className:"w-full bg-neutral-700 border border-neutral-600 rounded-lg px-4 py-2 pl-10 text-accent-cream placeholder-neutral-400 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"}),(0,a.jsx)("div",{className:"absolute left-3 top-2.5 text-neutral-400",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-6 mt-4 text-sm text-neutral-400",children:[(0,a.jsx)("span",{children:x?`Archivados: ${Array.isArray(w)?w.length:0} contactos`:`Activos: ${Array.isArray(w)?w.length:0} contactos`}),d&&(0,a.jsxs)("span",{children:["Filtrados: ",Array.isArray(P)?P.length:0," resultados"]})]})]}),(0,a.jsx)("div",{className:"flex-1 p-6",children:k?(0,a.jsxs)("div",{className:"bg-red-900/20 border border-red-700 rounded-lg p-6 text-center",children:[(0,a.jsx)("svg",{className:"w-12 h-12 mx-auto mb-4 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-red-400 mb-2",children:"Error al cargar contactos"}),(0,a.jsx)("p",{className:"text-red-300 mb-4",children:k}),(0,a.jsx)("button",{onClick:()=>C(),className:"bg-red-600 hover:bg-red-700 text-accent-cream px-4 py-2 rounded-lg transition-colors",children:"Intentar de nuevo"})]}):(0,a.jsx)(J,{items:P.map(e=>({id:e._id||e.id,name:e.name,phone:e.phone,email:e.email,integrationId:e.integrationId,provider:e.provider,avatar:e.avatar,profilePicture:e.profilePicture,lastInteraction:e.lastInteraction,lastMessagePreview:e.lastMessagePreview,isArchived:e.isArchived,platformData:e.platformData})),onArchive:$,onUnarchive:z,onMessage:function(e){let t=e.id,a=e.provider||r||"telegram";console.log("Opening inbox for contact:",{contactId:t,provider:a,integrationId:r}),window.location.href=`/dashboard/inbox?contact=${t}&channel=${a}`},isArchiving:m,loading:N,showArchived:x})})]})}},91664:(e,t,r)=>{"use strict";r.d(t,{d:()=>i,z:()=>l});var a=r(68819),s=r(17266),n=r.n(s),o=r(41135);let i=(e={})=>(0,o.W)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{"bg-primary text-primary-foreground hover:bg-primary/90":"default"===e.variant||!e.variant,"bg-destructive text-destructive-foreground hover:bg-destructive/90":"destructive"===e.variant,"border border-input bg-background hover:bg-accent hover:text-accent-foreground":"outline"===e.variant,"bg-secondary text-secondary-foreground hover:bg-secondary/80":"secondary"===e.variant,"hover:bg-accent hover:text-accent-foreground":"ghost"===e.variant,"text-primary underline-offset-4 hover:underline":"link"===e.variant},{"h-10 px-4 py-2":!0}),l=n().forwardRef(({className:e,variant:t="default",size:r="default",children:s,...n},i)=>(0,a.jsx)("button",{className:(0,o.W)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{"bg-primary text-primary-foreground hover:bg-primary/90":"default"===t,"bg-destructive text-destructive-foreground hover:bg-destructive/90":"destructive"===t,"border border-input bg-background hover:bg-accent hover:text-accent-foreground":"outline"===t,"bg-secondary text-secondary-foreground hover:bg-secondary/80":"secondary"===t,"hover:bg-accent hover:text-accent-foreground":"ghost"===t,"text-primary underline-offset-4 hover:underline":"link"===t},{"h-10 px-4 py-2":"default"===r,"h-9 rounded-md px-3":"sm"===r,"h-11 rounded-md px-8":"lg"===r,"h-10 w-10":"icon"===r},e),ref:i,...n,children:s}));l.displayName="Button"},38227:(e,t,r)=>{"use strict";r.d(t,{O:()=>n});var a=r(68819),s=r(41135);function n({className:e,...t}){return(0,a.jsx)("div",{className:(0,s.Z)("animate-pulse rounded-md bg-neutral-700",e),...t})}},99890:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});var a=r(17266),s=r(58838);function n(){let e=(0,a.useCallback)(()=>{(0,s.JG)(e=>Array.isArray(e)&&"/integrations"===e[0]),(0,s.JG)(e=>Array.isArray(e)&&"/contacts"===e[0]),(0,s.JG)(e=>Array.isArray(e)&&"/inbox"===e[0]),(0,s.JG)(e=>Array.isArray(e)&&"/messages"===e[0]),(0,s.JG)(e=>Array.isArray(e)&&"/conversations"===e[0])},[]),t=(0,a.useCallback)(()=>{(0,s.JG)(e=>Array.isArray(e)&&"/integrations"===e[0])},[]),r=(0,a.useCallback)(()=>{(0,s.JG)(e=>Array.isArray(e)&&"/contacts"===e[0])},[]);return{refreshAll:e,refreshIntegrations:t,refreshContacts:r,refreshInbox:(0,a.useCallback)(()=>{(0,s.JG)(e=>Array.isArray(e)&&"/inbox"===e[0])},[]),refreshMessages:(0,a.useCallback)(()=>{(0,s.JG)(e=>Array.isArray(e)&&"/messages"===e[0])},[]),refreshConversations:(0,a.useCallback)(()=>{(0,s.JG)(e=>Array.isArray(e)&&"/conversations"===e[0])},[])}}},40818:(e,t,r)=>{"use strict";r.d(t,{w:()=>s});var a=r(17266);function s(){let{showNotification:e}=function(){let[e,t]=(0,a.useState)([]),r=(0,a.useCallback)(e=>{let r=Math.random().toString(36).substr(2,9),a={id:r,duration:e.duration??5e3,...e};t(e=>[...e,a]),a.duration&&a.duration>0&&setTimeout(()=>{s(r)},a.duration)},[]),s=(0,a.useCallback)(e=>{t(t=>t.filter(t=>t.id!==e))},[]);return{notifications:e,showNotification:r,hideNotification:s,clearAll:(0,a.useCallback)(()=>{t([])},[])}}(),t=(0,a.useCallback)((t,r)=>{e({type:"success",title:t,message:r})},[e]);return{showSuccess:t,showError:(0,a.useCallback)((t,r)=>{e({type:"error",title:t,message:r,duration:0})},[e]),showInfo:(0,a.useCallback)((t,r)=>{e({type:"info",title:t,message:r})},[e]),showWarning:(0,a.useCallback)((t,r)=>{e({type:"warning",title:t,message:r})},[e])}}},53566:(e,t,r)=>{"use strict";r.d(t,{Du:()=>s,pD:()=>a});let a=["whatsapp","instagram","messenger","telegram"],s=[{id:"whatsapp",label:"WhatsApp",color:"bg-green-500",description:"Conecta tu cuenta de WhatsApp Business para enviar y recibir mensajes."},{id:"instagram",label:"Instagram",color:"bg-gradient-to-r from-purple-500 to-pink-500",description:"Conecta tu cuenta de Instagram para gestionar mensajes directos."},{id:"messenger",label:"Facebook Messenger",color:"bg-blue-500",description:"Conecta Facebook Messenger para gestionar conversaciones."},{id:"tiktok",label:"TikTok",color:"bg-black",description:"Conecta TikTok para gestionar mensajes y comentarios."},{id:"telegram",label:"Telegram",color:"bg-blue-500",description:"Conecta tu cuenta personal de Telegram para gestionar todos tus chats y mensajes."}]},51223:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var a=r(41135),s=r(31009);function n(...e){return(0,s.m6)((0,a.W)(e))}},82597:(e,t,r)=>{"use strict";r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>e});var s=r(71851);let e=(await (0,s.createProxy)(String.raw`C:\Users\Guido\Desktop\Guido\Nexly\web\src\app\(private)\dashboard\contacts\page.tsx`)).default;a()}catch(e){a(e)}},1)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[147,426,752,224,325,838,473,962,148],()=>r(18426));module.exports=a})();