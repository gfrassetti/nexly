(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9985],{94824:(e,t,a)=>{Promise.resolve().then(a.bind(a,25667))},16463:(e,t,a)=>{"use strict";var n=a(71169);a.o(n,"usePathname")&&a.d(t,{usePathname:function(){return n.usePathname}}),a.o(n,"useRouter")&&a.d(t,{useRouter:function(){return n.useRouter}}),a.o(n,"useSearchParams")&&a.d(t,{useSearchParams:function(){return n.useSearchParams}})},25667:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var n=a(57437),r=a(87138),o=a(2265),s=a(92800),l=a(53508);function i(){let[e,t]=(0,o.useState)(""),[a,i]=(0,o.useState)(!1),[c,d]=(0,o.useState)(""),[u,m]=(0,o.useState)(""),h=async t=>{t.preventDefault(),m(""),d(""),i(!0);try{let t=await fetch("".concat(s.T5,"/auth/forgot-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}),a=await t.json();t.ok?(d(a.message),a.resetUrl):m(a.message||"Error al enviar solicitud")}catch(e){m("Error de conexi\xf3n. Intenta nuevamente.")}finally{i(!1)}};return(0,n.jsx)(l.default,{requireAuth:!1,children:(0,n.jsx)("div",{className:"min-h-svh grid place-items-center p-6",children:(0,n.jsxs)("div",{className:"w-full max-w-sm space-y-4",children:[(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold mb-2",children:"Recuperar contrase\xf1a"}),(0,n.jsx)("p",{className:"text-gray-600 text-sm",children:"Ingresa tu email y te enviaremos un enlace para restablecer tu contrase\xf1a"})]}),(0,n.jsxs)("form",{onSubmit:h,className:"space-y-4",children:[u&&(0,n.jsx)("div",{className:"p-3 bg-red-100 border border-red-400 text-red-700 rounded text-sm",children:u}),c&&(0,n.jsx)("div",{className:"p-3 bg-green-100 border border-green-400 text-green-700 rounded text-sm",children:c}),(0,n.jsx)("input",{className:"w-full border rounded-md px-3 py-2 text-black",placeholder:"Email",type:"email",value:e,onChange:e=>t(e.target.value),required:!0}),(0,n.jsx)("button",{type:"submit",disabled:a,className:"w-full bg-black text-accent-cream rounded-md py-2 disabled:opacity-50",children:a?"Enviando...":"Enviar enlace de recuperaci\xf3n"})]}),(0,n.jsxs)("div",{className:"text-center space-y-2",children:[(0,n.jsx)("div",{children:(0,n.jsx)(r.default,{href:"/login",className:"text-blue-600 hover:underline text-sm",children:"← Volver al login"})}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("span",{className:"text-neutral-600 text-sm",children:["\xbfRecordaste tu contrase\xf1a?"," "]}),(0,n.jsx)(r.default,{href:"/login",className:"text-green-600 hover:underline text-sm font-medium",children:"Inicia sesi\xf3n aqu\xed"})]})]})]})})})}function c(){return(0,n.jsx)(o.Suspense,{fallback:(0,n.jsx)("div",{className:"min-h-svh grid place-items-center",children:(0,n.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-black border-t-transparent rounded-full"})}),children:(0,n.jsx)(i,{})})}},53508:(e,t,a)=>{"use strict";a.d(t,{default:()=>i});var n=a(57437),r=a(2265),o=a(16463),s=a(67048),l=a(61575);function i(e){let{children:t,requireAuth:a=!0}=e,i=(0,o.useRouter)(),{token:c,user:d,clear:u,isLoading:m}=(0,s.a)(),h=!!(c&&d);return((0,r.useEffect)(()=>{if(!m){if(a&&!h){console.log("\uD83D\uDEE1️ AuthGuard - Redirigiendo a login (requiere auth pero no est\xe1 autenticado)"),i.replace("/login");return}if(!a&&h){console.log("\uD83D\uDEE1️ AuthGuard - Redirigiendo a dashboard (est\xe1 autenticado pero en p\xe1gina de auth)"),i.replace("/dashboard");return}console.log("\uD83D\uDEE1️ AuthGuard - Permitiendo acceso")}},[h,m,a,i]),m)?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-accent-dark",children:(0,n.jsx)(l.ZP,{size:"lg",text:"Verificando autenticaci\xf3n..."})}):a&&!h||!a&&h?null:(0,n.jsx)(n.Fragment,{children:t})}},61575:(e,t,a)=>{"use strict";a.d(t,{ZP:()=>o});var n=a(57437),r=a(66648);function o(e){let{size:t="md",text:a,fullScreen:o=!1,className:s=""}=e,l={sm:"w-8 h-8",md:"w-12 h-12",lg:"w-16 h-16",xl:"w-24 h-24"},i={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8",xl:"w-12 h-12"},c={sm:"border-2",md:"border-[3px]",lg:"border-4",xl:"border-[5px]"},d=()=>(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 ".concat(s),children:[(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"\n            ".concat(l[t]," \n            ").concat(c[t],"\n            rounded-full \n            border-transparent\n            border-t-nexly-green \n            border-r-nexly-teal\n            animate-spin\n            shadow-nexly-green/30\n          "),style:{animationDuration:"1s",animationTimingFunction:"linear"}}),(0,n.jsx)("div",{className:"\n          ".concat(l[t]," \n          rounded-full \n          absolute top-0 left-0 \n          flex items-center justify-center\n          bg-gradient-to-br from-nexly-green/10 to-nexly-teal/10\n        "),children:(0,n.jsx)(r.default,{src:"/logo_single.png",alt:"Nexly",width:48,height:48,className:"".concat(i[t]," object-contain animate-pulse"),priority:!0})})]}),a&&(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("p",{className:"text-accent-cream font-medium text-sm tracking-wide mb-2",children:a}),(0,n.jsxs)("div",{className:"flex items-center justify-center gap-1.5",children:[(0,n.jsx)("div",{className:"w-1.5 h-1.5 bg-nexly-green rounded-full animate-bounce shadow-lg shadow-nexly-green/50"}),(0,n.jsx)("div",{className:"w-1.5 h-1.5 bg-nexly-teal rounded-full animate-bounce shadow-lg shadow-nexly-teal/50",style:{animationDelay:"0.15s"}}),(0,n.jsx)("div",{className:"w-1.5 h-1.5 bg-nexly-green rounded-full animate-bounce shadow-lg shadow-nexly-green/50",style:{animationDelay:"0.3s"}})]})]})]});return o?(0,n.jsx)("div",{className:"fixed inset-0 bg-gradient-to-br from-neutral-900 via-neutral-800 to-neutral-900 backdrop-blur-sm z-50 flex items-center justify-center",children:(0,n.jsx)(d,{})}):(0,n.jsx)(d,{})}},67048:(e,t,a)=>{"use strict";a.d(t,{a:()=>r});var n=a(2265);function r(){let[e,t]=(0,n.useState)(null),[a,r]=(0,n.useState)(null),[o,s]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{let e=localStorage.getItem("token"),a=localStorage.getItem("user");if(e&&a)try{let n=JSON.parse(a);r(e),t(n)}catch(e){localStorage.removeItem("token"),localStorage.removeItem("user")}s(!1)},[]),{user:e,token:a,setAuth:(e,a)=>{r(e),t(a),localStorage.setItem("token",e),localStorage.setItem("user",JSON.stringify(a))},clear:()=>{r(null),t(null),localStorage.removeItem("token"),localStorage.removeItem("user")},logout:()=>{console.log("\uD83D\uDD04 Logout manual iniciado..."),localStorage.removeItem("token"),localStorage.removeItem("user"),document.cookie="token=; Path=/; Max-Age=0; SameSite=Lax",sessionStorage.clear(),window.location.replace("/login")},isLoading:o,isAuthenticated:!!a&&!!e}}},92800:(e,t,a)=>{"use strict";a.d(t,{SC:()=>o,T5:()=>n,ZP:()=>u,aS:()=>i,oJ:()=>d,qL:()=>s,qi:()=>c,x4:()=>l});let n="https://nexly-production.up.railway.app".replace(/\/+$/,""),r=e=>"".concat(n).concat(e.startsWith("/")?e:"/".concat(e));async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,n=a||function(){if("undefined"==typeof document)return;let e=document.cookie.match(/(?:^|;\s*)token=([^;]+)/);return e?decodeURIComponent(e[1]):void 0}(),o=await fetch(r(e),{...t,headers:{"Content-Type":"application/json",...n?{Authorization:"Bearer ".concat(n)}:{},...t.headers||{}}});if(!o.ok){if(401===o.status)throw console.warn("\uD83D\uDD12 Token expirado detectado en:",e),console.warn("\uD83D\uDCC5 Timestamp:",new Date().toISOString()),localStorage.removeItem("token"),localStorage.removeItem("user"),document.cookie="token=; Path=/; Max-Age=0; SameSite=Lax",sessionStorage.clear(),console.warn("\uD83D\uDE80 Ejecutando logout autom\xe1tico..."),window.location.replace("/login"),Error("Sesi\xf3n expirada. Redirigiendo al login...");let t="HTTP ".concat(o.status);try{let e=await o.json();t=(null==e?void 0:e.message)||(null==e?void 0:e.error)||t}catch(e){}throw Error(t)}if(204!==o.status)return await o.json()}function s(e){return o("/auth/register",{method:"POST",body:JSON.stringify(e)})}function l(e){return o("/contacts/sync",{method:"POST"},e)}function i(e,t){return o("/contacts/sync/provider/".concat(e),{method:"POST"},t)}function c(e,t){let a=localStorage.getItem("token");return o("/ai/analyze",{method:"POST",headers:{"Content-Type":"application/json",...a&&{Authorization:"Bearer ".concat(a)}},body:JSON.stringify({message:e,context:t})})}function d(e,t){let a=localStorage.getItem("token");return o("/ai/generate-response",{method:"POST",headers:{"Content-Type":"application/json",...a&&{Authorization:"Bearer ".concat(a)}},body:JSON.stringify({message:e,businessContext:t})})}let u=o}},e=>{var t=t=>e(e.s=t);e.O(0,[7138,6648,7130,6215,1744],()=>t(94824)),_N_E=e.O()}]);