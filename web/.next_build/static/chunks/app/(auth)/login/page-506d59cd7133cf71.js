(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4665],{84856:(e,t,n)=>{Promise.resolve().then(n.bind(n,60204)),Promise.resolve().then(n.bind(n,53508))},16463:(e,t,n)=>{"use strict";var o=n(71169);n.o(o,"usePathname")&&n.d(t,{usePathname:function(){return o.usePathname}}),n.o(o,"useRouter")&&n.d(t,{useRouter:function(){return o.useRouter}}),n.o(o,"useSearchParams")&&n.d(t,{useSearchParams:function(){return o.useSearchParams}})},60204:(e,t,n)=>{"use strict";n.d(t,{default:()=>d});var o=n(57437),a=n(87138),r=n(2265),s=n(16463),l=n(67048),c=n(92800),i=n(70640);function d(){let[e,t]=(0,r.useState)(""),[n,d]=(0,r.useState)(""),[u,m]=(0,r.useState)(!1),[g,h]=(0,r.useState)(""),x=(0,s.useRouter)();(0,s.useSearchParams)();let{setAuth:f}=(0,l.a)();async function p(t){t.preventDefault(),h(""),m(!0);try{console.log("\uD83D\uDD10 Intentando login con:",{identifier:e,password:"***"});let t=await fetch("".concat(c.T5,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifier:e,password:n})});if(console.log("\uD83D\uDCE1 Respuesta del servidor:",t.status,t.statusText),!t.ok){let e=await t.json().catch(()=>({}));throw console.error("❌ Error del servidor:",e),Error(e.message||"Credenciales inv\xe1lidas")}let o=await t.json();console.log("✅ Login exitoso, datos recibidos:",{token:o.token?"***":"undefined",user:o.user}),localStorage.setItem("token",o.token),document.cookie="token=".concat(o.token,"; Path=/; SameSite=Lax"),f(o.token,o.user),console.log("\uD83D\uDE80 Redirigiendo al dashboard..."),x.replace("/dashboard")}catch(e){console.error("\uD83D\uDCA5 Error en login:",e),h(e.message||"Error de login")}finally{m(!1)}}return(0,o.jsxs)("div",{className:"w-full max-w-md",children:[(0,o.jsxs)("div",{className:"text-center mb-8",children:[(0,o.jsx)("div",{className:"flex justify-center mb-4",children:(0,o.jsx)(i.Z,{size:"md"})}),(0,o.jsx)("h1",{className:"text-lg font-medium text-foreground",children:"Iniciar sesi\xf3n"}),(0,o.jsx)("p",{className:"text-muted-foreground text-sm mt-2",children:"Bienvenido de vuelta"})]}),(0,o.jsxs)("form",{onSubmit:p,className:"space-y-6 bg-muted border border-border p-8 rounded-lg",children:[g&&(0,o.jsx)("p",{className:"text-sm text-destructive",children:g}),(0,o.jsx)("div",{children:(0,o.jsx)("input",{className:"w-full px-4 py-3 bg-background border border-border rounded-lg text-foreground placeholder-muted-foreground focus:outline-none focus:ring-2 focus:ring-accent-green focus:border-transparent transition-colors",placeholder:"Email o Username",value:e,onChange:e=>t(e.target.value)})}),(0,o.jsx)("div",{children:(0,o.jsx)("input",{className:"w-full px-4 py-3 bg-background border border-border rounded-lg text-foreground placeholder-muted-foreground focus:outline-none focus:ring-2 focus:ring-accent-green focus:border-transparent transition-colors",placeholder:"Contrase\xf1a",type:"password",value:n,onChange:e=>d(e.target.value)})}),(0,o.jsx)("button",{disabled:u,className:"w-full bg-accent-green/20 hover:bg-accent-green/30 disabled:bg-muted text-accent-green border border-accent-green/30 hover:border-accent-green/50 font-medium py-3 rounded-lg disabled:opacity-50 transition-colors duration-300",children:u?"Entrando...":"Entrar"}),(0,o.jsxs)("div",{className:"text-center space-y-3",children:[(0,o.jsx)("div",{children:(0,o.jsx)(a.default,{href:"/forgot-password",className:"text-accent-blue hover:text-accent-blue/80 text-sm transition-colors duration-300",children:"\xbfOlvidaste tu contrase\xf1a?"})}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("span",{className:"text-muted-foreground text-sm",children:["\xbfNo est\xe1s registrado?"," "]}),(0,o.jsx)(a.default,{href:(localStorage.removeItem("selectedPlan"),localStorage.removeItem("selectedPaymentMethod"),"/register"),className:"text-accent-green hover:text-accent-green/80 text-sm font-medium transition-colors duration-300",children:"Reg\xedstrate aqu\xed"})]})]})]})]})}},53508:(e,t,n)=>{"use strict";n.d(t,{default:()=>c});var o=n(57437),a=n(2265),r=n(16463),s=n(67048),l=n(61575);function c(e){let{children:t,requireAuth:n=!0}=e,c=(0,r.useRouter)(),{token:i,user:d,clear:u,isLoading:m}=(0,s.a)(),g=!!(i&&d);return((0,a.useEffect)(()=>{if(!m){if(n&&!g){console.log("\uD83D\uDEE1️ AuthGuard - Redirigiendo a login (requiere auth pero no est\xe1 autenticado)"),c.replace("/login");return}if(!n&&g){console.log("\uD83D\uDEE1️ AuthGuard - Redirigiendo a dashboard (est\xe1 autenticado pero en p\xe1gina de auth)"),c.replace("/dashboard");return}console.log("\uD83D\uDEE1️ AuthGuard - Permitiendo acceso")}},[g,m,n,c]),m)?(0,o.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-accent-dark",children:(0,o.jsx)(l.ZP,{size:"lg",text:"Verificando autenticaci\xf3n..."})}):n&&!g||!n&&g?null:(0,o.jsx)(o.Fragment,{children:t})}},61575:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>r});var o=n(57437),a=n(66648);function r(e){let{size:t="md",text:n,fullScreen:r=!1,className:s=""}=e,l={sm:"w-8 h-8",md:"w-12 h-12",lg:"w-16 h-16",xl:"w-24 h-24"},c={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8",xl:"w-12 h-12"},i={sm:"border-2",md:"border-[3px]",lg:"border-4",xl:"border-[5px]"},d=()=>(0,o.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 ".concat(s),children:[(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("div",{className:"\n            ".concat(l[t]," \n            ").concat(i[t],"\n            rounded-full \n            border-transparent\n            border-t-nexly-green \n            border-r-nexly-teal\n            animate-spin\n            shadow-nexly-green/30\n          "),style:{animationDuration:"1s",animationTimingFunction:"linear"}}),(0,o.jsx)("div",{className:"\n          ".concat(l[t]," \n          rounded-full \n          absolute top-0 left-0 \n          flex items-center justify-center\n          bg-gradient-to-br from-nexly-green/10 to-nexly-teal/10\n        "),children:(0,o.jsx)(a.default,{src:"/logo_single.png",alt:"Nexly",width:48,height:48,className:"".concat(c[t]," object-contain animate-pulse"),priority:!0})})]}),n&&(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("p",{className:"text-accent-cream font-medium text-sm tracking-wide mb-2",children:n}),(0,o.jsxs)("div",{className:"flex items-center justify-center gap-1.5",children:[(0,o.jsx)("div",{className:"w-1.5 h-1.5 bg-nexly-green rounded-full animate-bounce shadow-lg shadow-nexly-green/50"}),(0,o.jsx)("div",{className:"w-1.5 h-1.5 bg-nexly-teal rounded-full animate-bounce shadow-lg shadow-nexly-teal/50",style:{animationDelay:"0.15s"}}),(0,o.jsx)("div",{className:"w-1.5 h-1.5 bg-nexly-green rounded-full animate-bounce shadow-lg shadow-nexly-green/50",style:{animationDelay:"0.3s"}})]})]})]});return r?(0,o.jsx)("div",{className:"fixed inset-0 bg-gradient-to-br from-neutral-900 via-neutral-800 to-neutral-900 backdrop-blur-sm z-50 flex items-center justify-center",children:(0,o.jsx)(d,{})}):(0,o.jsx)(d,{})}},70640:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var o=n(57437),a=n(87138);function r(e){let{href:t="/",className:n="",showText:r=!1,textClassName:s="text-xl font-bold",size:l="md"}=e,c=(0,o.jsxs)("div",{className:"flex items-center gap-3 ".concat(n),children:[(0,o.jsx)("div",{className:"".concat({sm:"w-24",md:"w-32",lg:"w-40"}[l]," flex items-center justify-center"),children:(0,o.jsx)("img",{src:"/logo_nexly.png",alt:"Nexly Logo",className:"w-full h-full object-contain"})}),r&&(0,o.jsx)("span",{className:"".concat(s),children:"Nexly"})]});return t?(0,o.jsx)(a.default,{href:t,className:"inline-block hover:opacity-80 transition-opacity duration-300",children:c}):c}},67048:(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var o=n(2265);function a(){let[e,t]=(0,o.useState)(null),[n,a]=(0,o.useState)(null),[r,s]=(0,o.useState)(!0);return(0,o.useEffect)(()=>{let e=localStorage.getItem("token"),n=localStorage.getItem("user");if(e&&n)try{let o=JSON.parse(n);a(e),t(o)}catch(e){localStorage.removeItem("token"),localStorage.removeItem("user")}s(!1)},[]),{user:e,token:n,setAuth:(e,n)=>{a(e),t(n),localStorage.setItem("token",e),localStorage.setItem("user",JSON.stringify(n))},clear:()=>{a(null),t(null),localStorage.removeItem("token"),localStorage.removeItem("user")},logout:()=>{console.log("\uD83D\uDD04 Logout manual iniciado..."),localStorage.removeItem("token"),localStorage.removeItem("user"),document.cookie="token=; Path=/; Max-Age=0; SameSite=Lax",sessionStorage.clear(),window.location.replace("/login")},isLoading:r,isAuthenticated:!!n&&!!e}}},92800:(e,t,n)=>{"use strict";n.d(t,{SC:()=>r,T5:()=>o,ZP:()=>u,aS:()=>c,oJ:()=>d,qL:()=>s,qi:()=>i,x4:()=>l});let o="https://nexly-production.up.railway.app".replace(/\/+$/,""),a=e=>"".concat(o).concat(e.startsWith("/")?e:"/".concat(e));async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,o=n||function(){if("undefined"==typeof document)return;let e=document.cookie.match(/(?:^|;\s*)token=([^;]+)/);return e?decodeURIComponent(e[1]):void 0}(),r=await fetch(a(e),{...t,headers:{"Content-Type":"application/json",...o?{Authorization:"Bearer ".concat(o)}:{},...t.headers||{}}});if(!r.ok){if(401===r.status)throw console.warn("\uD83D\uDD12 Token expirado detectado en:",e),console.warn("\uD83D\uDCC5 Timestamp:",new Date().toISOString()),localStorage.removeItem("token"),localStorage.removeItem("user"),document.cookie="token=; Path=/; Max-Age=0; SameSite=Lax",sessionStorage.clear(),console.warn("\uD83D\uDE80 Ejecutando logout autom\xe1tico..."),window.location.replace("/login"),Error("Sesi\xf3n expirada. Redirigiendo al login...");let t="HTTP ".concat(r.status);try{let e=await r.json();t=(null==e?void 0:e.message)||(null==e?void 0:e.error)||t}catch(e){}throw Error(t)}if(204!==r.status)return await r.json()}function s(e){return r("/auth/register",{method:"POST",body:JSON.stringify(e)})}function l(e){return r("/contacts/sync",{method:"POST"},e)}function c(e,t){return r("/contacts/sync/provider/".concat(e),{method:"POST"},t)}function i(e,t){let n=localStorage.getItem("token");return r("/ai/analyze",{method:"POST",headers:{"Content-Type":"application/json",...n&&{Authorization:"Bearer ".concat(n)}},body:JSON.stringify({message:e,context:t})})}function d(e,t){let n=localStorage.getItem("token");return r("/ai/generate-response",{method:"POST",headers:{"Content-Type":"application/json",...n&&{Authorization:"Bearer ".concat(n)}},body:JSON.stringify({message:e,businessContext:t})})}let u=r}},e=>{var t=t=>e(e.s=t);e.O(0,[7138,6648,7130,6215,1744],()=>t(84856)),_N_E=e.O()}]);