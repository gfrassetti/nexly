(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{10594:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,63275,23)),Promise.resolve().then(r.bind(r,59366)),Promise.resolve().then(r.bind(r,29058)),Promise.resolve().then(r.bind(r,76737))},78030:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var a=r(2265);let o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),s=e=>{let t=n(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},l=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let u=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:o=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:u="",children:d,iconNode:m,...h}=e;return(0,a.createElement)("svg",{ref:t,...c,width:o,height:o,stroke:r,strokeWidth:s?24*Number(n)/Number(o):n,className:i("lucide",u),...!d&&!l(h)&&{"aria-hidden":"true"},...h},[...m.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),d=(e,t)=>{let r=(0,a.forwardRef)((r,n)=>{let{className:l,...c}=r;return(0,a.createElement)(u,{ref:n,iconNode:t,className:i("lucide-".concat(o(s(e))),"lucide-".concat(e),l),...c})});return r.displayName=s(e),r}},3274:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(78030).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},59366:(e,t,r)=>{"use strict";r.d(t,{Toaster:()=>d});var a=r(57437),o=r(78030);let n=(0,o.Z)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),s=(0,o.Z)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),i=(0,o.Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),l=(0,o.Z)("octagon-x",[["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"M2.586 16.726A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2h6.624a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688a2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586z",key:"2d38gg"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var c=r(3274),u=r(27776);let d=e=>{let{...t}=e;return(0,a.jsx)(u.x7,{theme:"dark",className:"toaster group",icons:{success:(0,a.jsx)(n,{className:"size-4"}),info:(0,a.jsx)(s,{className:"size-4"}),warning:(0,a.jsx)(i,{className:"size-4"}),error:(0,a.jsx)(l,{className:"size-4"}),loading:(0,a.jsx)(c.Z,{className:"size-4 animate-spin"})},style:{"--normal-bg":"hsl(var(--background))","--normal-text":"hsl(var(--foreground))","--normal-border":"hsl(var(--border))","--border-radius":"0.5rem"},...t})}},29058:(e,t,r)=>{"use strict";r.d(t,{StatsProvider:()=>l});var a=r(57437),o=r(2265),n=r(67048),s=r(92800);let i=(0,o.createContext)(void 0);function l(e){let{children:t}=e,{token:r}=(0,n.a)(),[l,c]=(0,o.useState)({activeIntegrations:0,unreadMessages:0}),[u,d]=(0,o.useState)(!0),[m,h]=(0,o.useState)(null),g=async()=>{if(r)try{d(!0),h(null);let e=await (0,s.SC)("/analytics/dashboard",{},r);e.success?c(e.data):(console.warn("Error en respuesta de stats:",e.message),c({activeIntegrations:0,unreadMessages:0}))}catch(e){console.error("Error fetching stats:",e),c({activeIntegrations:0,unreadMessages:0})}finally{d(!1)}},p=async()=>{await g()};return(0,o.useEffect)(()=>{g()},[r]),(0,a.jsx)(i.Provider,{value:{stats:l,isLoading:u,error:m,refreshStats:p},children:t})}},76737:(e,t,r)=>{"use strict";r.d(t,{SubscriptionInfoProvider:()=>i});var a=r(57437),o=r(2265),n=r(67048);let s=(0,o.createContext)(void 0);function i(e){let{children:t}=e,{user:r}=(0,n.a)(),[i,l]=(0,o.useState)(null),[c,u]=(0,o.useState)(null),[d,m]=(0,o.useState)(null),[h,g]=(0,o.useState)(!0),[p,f]=(0,o.useState)(null),v=async()=>{if(!(null==r?void 0:r.id)){g(!1);return}g(!0),f(null);try{let e=localStorage.getItem("token"),t=await fetch("/api/stripe/subscription-info",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(t.ok){let e=await t.json();l(e.subscription||null),u(e.customer||null),m(e.paymentMethod||null)}else{let e=await t.json();f(e.error||"Error al cargar informaci\xf3n de suscripci\xf3n")}}catch(e){console.error("Error al cargar suscripci\xf3n",e),f("Error de conexi\xf3n al cargar suscripci\xf3n")}finally{g(!1)}};return(0,o.useEffect)(()=>{v()},[null==r?void 0:r.id]),(0,a.jsx)(s.Provider,{value:{subscription:i,customer:c,paymentMethod:d,loading:h,error:p,refetch:v},children:t})}},67048:(e,t,r)=>{"use strict";r.d(t,{a:()=>o});var a=r(2265);function o(){let[e,t]=(0,a.useState)(null),[r,o]=(0,a.useState)(null),[n,s]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=localStorage.getItem("token"),r=localStorage.getItem("user");if(e&&r)try{let a=JSON.parse(r);o(e),t(a)}catch(e){localStorage.removeItem("token"),localStorage.removeItem("user")}s(!1)},[]),{user:e,token:r,setAuth:(e,r)=>{o(e),t(r),localStorage.setItem("token",e),localStorage.setItem("user",JSON.stringify(r))},clear:()=>{o(null),t(null),localStorage.removeItem("token"),localStorage.removeItem("user")},logout:()=>{console.log("\uD83D\uDD04 Logout manual iniciado..."),localStorage.removeItem("token"),localStorage.removeItem("user"),document.cookie="token=; Path=/; Max-Age=0; SameSite=Lax",sessionStorage.clear(),window.location.replace("/login")},isLoading:n,isAuthenticated:!!r&&!!e}}},92800:(e,t,r)=>{"use strict";r.d(t,{SC:()=>n,T5:()=>a,ZP:()=>d,aS:()=>l,oJ:()=>u,qL:()=>s,qi:()=>c,x4:()=>i});let a="https://nexly-production.up.railway.app".replace(/\/+$/,""),o=e=>"".concat(a).concat(e.startsWith("/")?e:"/".concat(e));async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,a=r||function(){if("undefined"==typeof document)return;let e=document.cookie.match(/(?:^|;\s*)token=([^;]+)/);return e?decodeURIComponent(e[1]):void 0}(),n=await fetch(o(e),{...t,headers:{"Content-Type":"application/json",...a?{Authorization:"Bearer ".concat(a)}:{},...t.headers||{}}});if(!n.ok){if(401===n.status)throw console.warn("\uD83D\uDD12 Token expirado detectado en:",e),console.warn("\uD83D\uDCC5 Timestamp:",new Date().toISOString()),localStorage.removeItem("token"),localStorage.removeItem("user"),document.cookie="token=; Path=/; Max-Age=0; SameSite=Lax",sessionStorage.clear(),console.warn("\uD83D\uDE80 Ejecutando logout autom\xe1tico..."),window.location.replace("/login"),Error("Sesi\xf3n expirada. Redirigiendo al login...");let t="HTTP ".concat(n.status);try{let e=await n.json();t=(null==e?void 0:e.message)||(null==e?void 0:e.error)||t}catch(e){}throw Error(t)}if(204!==n.status)return await n.json()}function s(e){return n("/auth/register",{method:"POST",body:JSON.stringify(e)})}function i(e){return n("/contacts/sync",{method:"POST"},e)}function l(e,t){return n("/contacts/sync/provider/".concat(e),{method:"POST"},t)}function c(e,t){let r=localStorage.getItem("token");return n("/ai/analyze",{method:"POST",headers:{"Content-Type":"application/json",...r&&{Authorization:"Bearer ".concat(r)}},body:JSON.stringify({message:e,context:t})})}function u(e,t){let r=localStorage.getItem("token");return n("/ai/generate-response",{method:"POST",headers:{"Content-Type":"application/json",...r&&{Authorization:"Bearer ".concat(r)}},body:JSON.stringify({message:e,businessContext:t})})}let d=n},63275:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[6757,7776,7130,6215,1744],()=>t(10594)),_N_E=e.O()}]);