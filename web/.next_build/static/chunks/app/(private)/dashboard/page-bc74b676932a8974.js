(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2119],{2063:(e,t,r)=>{Promise.resolve().then(r.bind(r,14223))},14223:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>$});var a=r(57437),s=r(2265),n=r(16463),o=r(67048),i=r(92800),l=r(2183);let c={blue:"bg-accent-blue/20 text-accent-blue",teal:"bg-accent-teal/20 text-accent-teal",green:"bg-accent-green/20 text-accent-green",purple:"bg-purple-500/20 text-purple-400",gray:"bg-gray-500/20 text-gray-400",red:"bg-red-500/20 text-red-400"};function d(e){let{title:t,value:r,subtitle:s,icon:n,color:o="blue",trend:i}=e;return(0,a.jsxs)("div",{className:"bg-muted/50 border border-border rounded-lg p-4 hover:bg-muted/80 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-muted-foreground font-medium",children:t}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-foreground mt-1",children:r}),s&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:s})]}),(0,a.jsx)("div",{className:"w-8 h-8 ".concat(c[o]," rounded-md flex items-center justify-center"),children:n})]}),i&&(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-border",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-xs font-medium ".concat(i.isPositive?"text-accent-green":"text-red-400"),children:[i.isPositive?"+":"",i.value]}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:i.label})]})})]})}var u=r(12104),m=r(64673);let x=()=>{let[e,t]=(0,s.useState)(!1),{token:r}=(0,o.a)();return{createPaymentLink:async e=>{if(!r)throw Error("Usuario no autenticado");t(!0);try{localStorage.setItem("selectedPlan",e);let t=await (0,i.ZP)("/stripe/create-payment-link",{method:"POST",body:JSON.stringify({planType:e,payment_behavior:"default_incomplete",payment_method_types:["card"]})},r);if(t.success&&t.paymentUrl)return window.location.href=t.paymentUrl,!0;throw Error("Error al crear el enlace de pago")}catch(e){var a,s,n,o,l;if(console.error("Error creating Stripe payment link:",e),null===(a=e.message)||void 0===a?void 0:a.includes("card_declined"))throw Error("Tu tarjeta fue rechazada. Por favor, intenta con otra tarjeta.");if(null===(s=e.message)||void 0===s?void 0:s.includes("insufficient_funds"))throw Error("Fondos insuficientes. Por favor, verifica tu saldo.");if(null===(n=e.message)||void 0===n?void 0:n.includes("expired_card"))throw Error("Tu tarjeta ha expirado. Por favor, usa otra tarjeta.");if(null===(o=e.message)||void 0===o?void 0:o.includes("incorrect_cvc"))throw Error("C\xf3digo de seguridad incorrecto. Por favor, verifica tu CVC.");else if(null===(l=e.message)||void 0===l?void 0:l.includes("processing_error"))throw Error("Error de procesamiento. Por favor, intenta nuevamente.");else if(e.message)throw Error(e.message);else throw Error("Error al crear el enlace de pago")}finally{t(!1)}},retryPayment:async e=>{if(!r)throw Error("Usuario no autenticado");t(!0);try{let t=await (0,i.ZP)("/stripe/retry-payment",{method:"POST",body:JSON.stringify({subscriptionId:e})},r);if(t.success)return t;throw Error("Error al reintentar el pago")}catch(e){throw console.error("Error retrying payment:",e),e}finally{t(!1)}},updatePaymentMethod:async(e,a)=>{if(!r)throw Error("Usuario no autenticado");t(!0);try{let t=await (0,i.ZP)("/stripe/update-payment-method",{method:"POST",body:JSON.stringify({subscriptionId:e,paymentMethodId:a})},r);if(t.success)return t;throw Error("Error al actualizar el m\xe9todo de pago")}catch(e){throw console.error("Error updating payment method:",e),e}finally{t(!1)}},loading:e}};var h=r(27776);function g(){var e;let[t,r]=(0,s.useState)(!1),{subscription:n,loading:o,error:i,refetch:l,getMaxIntegrations:c,status:d}=(0,u.mU)(),{createPaymentLink:g}=(0,m.A)(),{createPaymentLink:p,retryPayment:f,loading:b}=x();if(o)return(0,a.jsx)("div",{className:"bg-neutral-800 rounded-lg p-4 border border-neutral-700",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-4 bg-neutral-700 rounded w-1/3 mb-2"}),(0,a.jsx)("div",{className:"h-3 bg-neutral-700 rounded w-2/3"})]})});if(i){let e=i.includes("Demasiados intentos")||i.includes("429");return(0,a.jsx)("div",{className:"bg-nexly-light-blue/20 border border-nexly-light-blue/50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-nexly-light-blue mb-2",children:"Error al cargar suscripci\xf3n"}),(0,a.jsx)("p",{className:"text-sm text-nexly-light-blue/80",children:i}),e&&(0,a.jsx)("p",{className:"text-xs text-nexly-light-blue/60 mt-1",children:"⏰ El l\xedmite de intentos se resetea autom\xe1ticamente en 15 minutos"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:l,disabled:e,className:"px-4 py-2 rounded-lg transition-colors text-sm ".concat(e?"bg-muted text-muted-foreground cursor-not-allowed border border-border":"bg-accent-blue/20 hover:bg-accent-blue/30 text-accent-blue border border-accent-blue/30"),children:"Reintentar"}),e&&!1]})]})})}if(d.incomplete&&!d.active)return(0,a.jsx)("div",{className:"bg-accent-cream/10 border border-accent-cream/20 rounded-lg p-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-4",children:[(0,a.jsx)("svg",{className:"w-6 h-6 text-accent-cream",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-accent-cream",children:"Pago Requiere Acci\xf3n"})]}),(0,a.jsx)("p",{className:"text-accent-cream/80 mb-6",children:"Tu pago requiere autenticaci\xf3n adicional (3D Secure) o hay un problema con tu m\xe9todo de pago."}),(0,a.jsx)("div",{className:"flex flex-col sm:flex-row gap-3 justify-center items-center",children:(0,a.jsxs)("button",{onClick:()=>{p(localStorage.getItem("selectedPlan")||"crecimiento")},disabled:b,className:"bg-accent-cream/20 hover:bg-accent-cream/30 disabled:bg-accent-cream/10 disabled:opacity-50 text-accent-cream border border-accent-cream/30 px-6 py-3 rounded-lg transition-colors duration-300 flex items-center gap-3 min-w-[200px]",children:[(0,a.jsx)("img",{src:"/strapi_logo.png",alt:"Stripe",className:"h-5 w-auto"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"font-medium",children:"Completar Pago"}),(0,a.jsx)("p",{className:"text-xs opacity-90",children:"Resolver problema de pago"})]})]})})]})});if(d.pastDue&&!d.active)return(0,a.jsx)("div",{className:"bg-accent-red/10 border border-accent-red/20 rounded-lg p-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-4",children:[(0,a.jsx)("svg",{className:"w-6 h-6 text-accent-red",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-accent-red",children:"Pago Vencido"})]}),(0,a.jsx)("p",{className:"text-accent-red/80 mb-6",children:"Tu \xfaltimo pago fall\xf3. Actualiza tu m\xe9todo de pago para reactivar tu suscripci\xf3n."}),(0,a.jsx)("div",{className:"flex flex-col sm:flex-row gap-3 justify-center items-center",children:(0,a.jsxs)("button",{onClick:async()=>{var e;if(null==n?void 0:null===(e=n.subscription)||void 0===e?void 0:e.stripeSubscriptionId)try{await f(n.subscription.stripeSubscriptionId),l()}catch(e){console.error("Error retrying payment:",e)}},disabled:b,className:"bg-accent-red/20 hover:bg-accent-red/30 disabled:bg-accent-red/10 disabled:opacity-50 text-accent-red border border-accent-red/30 px-6 py-3 rounded-lg transition-colors duration-300 flex items-center gap-3 min-w-[200px]",children:[(0,a.jsx)("img",{src:"/strapi_logo.png",alt:"Stripe",className:"h-5 w-auto"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"font-medium",children:"Reintentar Pago"}),(0,a.jsx)("p",{className:"text-xs opacity-90",children:"Actualizar m\xe9todo de pago"})]})]})})]})});if(d.pendingPaymentMethod&&!d.active)return(0,a.jsx)("div",{className:"bg-warning/10 border border-warning/20 rounded-lg p-6",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-4",children:[(0,a.jsx)("svg",{className:"w-6 h-6 text-warning",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-warning",children:"Pago Pendiente"})]}),(0,a.jsx)("p",{className:"text-warning/80 mb-6",children:"Tu cuenta est\xe1 registrada pero necesitas completar el m\xe9todo de pago para activar tu suscripci\xf3n."}),(0,a.jsx)("div",{className:"flex flex-col sm:flex-row gap-3 justify-center items-center",children:(0,a.jsxs)("button",{onClick:()=>{p(localStorage.getItem("selectedPlan")||"crecimiento")},disabled:b,className:"bg-purple-600 hover:bg-purple-700 disabled:bg-purple-800 disabled:opacity-50 text-accent-cream px-6 py-3 rounded-lg transition-colors duration-300 flex items-center gap-3 min-w-[200px]",children:[(0,a.jsx)("img",{src:"/strapi_logo.png",alt:"Stripe",className:"h-5 w-auto"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"font-medium",children:"Completar Pago"}),(0,a.jsx)("p",{className:"text-xs opacity-90",children:"Activar tu suscripci\xf3n"})]})]})})]})});if(d.cancelled||!(null==n?void 0:n.hasSubscription))return console.log(" sub status jsx"),console.log("status",d),console.log("subscription",n),(0,a.jsx)("div",{className:"bg-neutral-800 no-subcription-layout rounded-lg p-6 border border-neutral-700",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-accent-cream mb-2",children:"Sin suscripci\xf3n activa"}),(0,a.jsx)("p",{className:"text-neutral-400 mb-4",children:"Para usar todas las funciones, elige un plan"}),(0,a.jsx)("a",{href:"/pricing",className:"bg-nexly-teal hover:bg-nexly-green text-accent-cream px-4 py-2 rounded-lg transition-colors duration-300",children:"Ver Planes"})]})});let v=n.subscription,j=d.cancelled&&!v.isInGracePeriod,y=!!(v.trialEndDate&&new Date(v.trialEndDate)>new Date&&!d.cancelled&&"canceled"!==v.status),N=d.active?{text:"Activo",className:"text-accent-green border border-accent-green/30",message:"Suscripci\xf3n activa y renovando autom\xe1ticamente"}:d.paused?{text:"Pausada",className:"text-accent-cream border border-accent-cream/30",message:"Suscripci\xf3n pausada. Puedes reactivarla cuando quieras"}:({trialing:{text:y?"En Prueba":"Prueba Expirada",className:y?"text-accent-blue border border-accent-blue/30":"text-warning border border-warning/30",message:y?"Per\xedodo de prueba activo":"Per\xedodo de prueba terminado. Se requiere pago para continuar"},incomplete:{text:"Incompleto",className:"text-warning border border-warning/30",message:null},past_due:{text:"Vencido",className:"text-accent-red border border-accent-red/30",message:null},canceled:{text:"Cancelado",className:"text-accent-blue border border-accent-blue/30",message:null},unpaid:{text:"No pagado",className:"text-accent-red border border-accent-red/30",message:null}})[v.status]||{text:"Desconocido (".concat(v.status,")"),className:"text-muted-foreground boimage.pngrder border-border",message:null};return(0,a.jsxs)("div",{className:"rounded-lg p-6 border ".concat(j?"bg-nexly-light-blue/20 border-nexly-light-blue/50":d.paused?"bg-accent-cream/10 border-accent-cream/20":v.isInGracePeriod?"bg-warning/10 border-warning/20":d.active?"bg-accent-green/10 border-accent-green/20":"bg-muted border-border"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-accent-cream",children:"crecimiento"===v.planType?"Plan Crecimiento":"pro"===v.planType?"Plan Pro":"business"===v.planType?"Plan Business":"Plan B\xe1sico"}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-md text-xs font-medium bg-transparent ".concat(N.className),children:N.text})]}),N.message&&(0,a.jsx)("p",{className:"text-sm ".concat(d.active?"text-accent-green":d.paused?"text-accent-cream":"trialing"===v.status?"text-accent-blue":"text-neutral-300"),children:N.message}),v.isInGracePeriod&&(0,a.jsxs)("p",{className:"text-sm text-warning",children:["⏰ Per\xedodo de gracia: ",v.gracePeriodDaysRemaining," d\xedas restantes"]}),j&&(0,a.jsx)("p",{className:"text-sm text-nexly-light-blue",children:"❌ Suscripci\xf3n expirada. Actualiza para continuar"}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("p",{className:"text-sm text-neutral-300",children:999===c()?"Integraciones: Todas disponibles":"Integraciones: Hasta ".concat(c()," plataformas")})})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[j&&(0,a.jsx)("button",{onClick:()=>g(),className:"bg-accent-green/20 hover:bg-accent-green/30 text-accent-green border border-accent-green/30 px-4 py-2 rounded-lg transition-colors text-sm",children:"Volver a comprar"}),"trialing"===v.status&&!y&&(0,a.jsx)("button",{onClick:()=>{let e=v.planType,t=localStorage.getItem("selectedPlan");p(e||t||"crecimiento")},className:"bg-warning/20 hover:bg-warning/30 text-warning border border-warning/30 px-4 py-2 rounded-lg transition-colors text-sm",children:"Completar Pago"}),d.paused&&!y&&(0,a.jsx)("button",{onClick:()=>window.location.href="/dashboard/subscription/stripe",className:"bg-accent-green/20 hover:bg-accent-green/30 text-accent-green border border-accent-green/30 px-4 py-2 rounded-lg transition-colors text-sm",children:"Reactivar"}),d.active&&!y&&(0,a.jsx)("button",{onClick:()=>window.location.href="/dashboard/subscription/stripe",className:"bg-accent-cream/20 hover:bg-accent-cream/30 text-accent-cream border border-accent-cream/30 px-4 py-2 rounded-lg transition-colors text-sm",children:"Pausar"}),(d.active||d.paused)&&!y&&(0,a.jsx)("button",{onClick:()=>window.location.href="/dashboard/subscription/stripe",className:"bg-nexly-light-blue hover:bg-nexly-light-blue/80 text-accent-cream px-4 py-2 rounded-lg transition-colors text-sm",children:"Cancelar"}),d.active&&!y&&(0,a.jsx)("button",{onClick:()=>window.location.href="/pricing",className:"bg-neutral-600 hover:bg-neutral-700 text-accent-cream px-4 py-2 rounded-lg transition-colors text-sm",children:"Cambiar plan"}),y&&(0,a.jsxs)("button",{onClick:async()=>{r(!0);try{window.location.href="/dashboard/subscription/stripe"}catch(e){console.error("Error cancelando per\xedodo de prueba:",e),h.Am.error("Error al cancelar",{description:"No se pudo cancelar el per\xedodo de prueba. Intenta de nuevo."})}finally{r(!1)}},disabled:t,className:"bg-accent-red/20 hover:bg-accent-red/30 disabled:bg-accent-red/10 disabled:opacity-50 text-accent-red border border-accent-red/30 px-4 py-2 rounded-lg transition-colors text-sm flex items-center gap-2",children:[t&&(0,a.jsxs)("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t?"Cancelando...":"Cancelar Per\xedodo de Prueba"]})]})]}),v.isInGracePeriod&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm text-neutral-400 mb-1",children:[(0,a.jsx)("span",{children:"Per\xedodo de gracia"}),(0,a.jsxs)("span",{children:[v.gracePeriodDaysRemaining," d\xedas restantes"]})]}),(0,a.jsx)("div",{className:"w-full bg-neutral-700 rounded-full h-2",children:(0,a.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 bg-warning",style:{width:"".concat(Math.max(0,(7-(null!==(e=v.gracePeriodDaysRemaining)&&void 0!==e?e:0))/7*100),"%")}})})]})]})}var p=r(53225),f=r(27561),b=r(54142),v=r(2842),j=r(59688),y=r(48185),N=r(35231),w=r(35307),k=r(17379),S=r(44839),C=r(96164);function P(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,C.m6)((0,S.W)(t))}let L={light:"",dark:".dark"},E=s.createContext(null);function M(){let e=s.useContext(E);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}let I=s.forwardRef((e,t)=>{let{id:r,className:n,children:o,config:i,...l}=e,c=s.useId(),d="chart-".concat(r||c.replace(/:/g,""));return(0,a.jsx)(E.Provider,{value:{config:i},children:(0,a.jsxs)("div",{"data-chart":d,ref:t,className:P("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",n),...l,children:[(0,a.jsx)(O,{id:d,config:i}),(0,a.jsx)(N.h,{children:o})]})})});I.displayName="ChartContainer";let O=e=>{let{id:t,config:r}=e,s=Object.entries(r).filter(e=>{let[t,r]=e;return r.theme||r.color});return s.length?(0,a.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(L).map(e=>{let[r,a]=e;return"\n".concat(a," [data-chart=").concat(t,"] {\n").concat(s.map(e=>{var t;let[a,s]=e,n=(null===(t=s.theme)||void 0===t?void 0:t[r])||s.color;return n?"  --color-".concat(a,": ").concat(n,";"):null}).join("\n"),"\n}\n")}).join("\n")}}):null},T=w.u,_=s.forwardRef((e,t)=>{let{active:r,payload:n,className:o,indicator:i="dot",hideLabel:l=!1,hideIndicator:c=!1,label:d,labelFormatter:u,labelClassName:m,formatter:x,color:h,nameKey:g,labelKey:p}=e,{config:f}=M(),b=s.useMemo(()=>{var e;if(l||!(null==n?void 0:n.length))return null;let[t]=n,r=f["".concat(p||t.dataKey||t.name||"value")],s=p||"string"!=typeof d?null==r?void 0:r.label:(null===(e=f[d])||void 0===e?void 0:e.label)||d;return u?(0,a.jsx)("div",{className:P("font-medium",m),children:u(s,n)}):s?(0,a.jsx)("div",{className:P("font-medium",m),children:s}):null},[d,u,n,l,m,f,p]);if(!r||!(null==n?void 0:n.length))return null;let v=1===n.length&&"dot"!==i;return(0,a.jsxs)("div",{ref:t,className:P("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",o),children:[v?null:b,(0,a.jsx)("div",{className:"grid gap-1.5",children:n.map((e,t)=>{let r=f["".concat(g||e.name||e.dataKey||"value")],s=h||e.payload.fill||e.color;return(0,a.jsx)("div",{className:P("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===i&&"items-center"),children:x&&(null==e?void 0:e.value)!==void 0&&e.name?x(e.value,e.name,e,t,e.payload):(0,a.jsxs)(a.Fragment,{children:[(null==r?void 0:r.icon)?(0,a.jsx)(r.icon,{}):!c&&(0,a.jsx)("div",{className:P("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":"dot"===i,"w-1":"line"===i,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===i,"my-0.5":v&&"dashed"===i}),style:{"--color-bg":s,"--color-border":s}}),(0,a.jsxs)("div",{className:P("flex flex-1 justify-between leading-none",v?"items-end":"items-center"),children:[(0,a.jsxs)("div",{className:"grid gap-1.5",children:[v?b:null,(0,a.jsx)("span",{className:"text-muted-foreground",children:(null==r?void 0:r.label)||e.name})]}),e.value&&(0,a.jsx)("span",{className:"font-mono font-medium tabular-nums text-foreground",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})});_.displayName="ChartTooltipContent",k.D,s.forwardRef((e,t)=>{let{className:r,hideIcon:s=!1,payload:n,verticalAlign:o="bottom",nameKey:i}=e,{config:l}=M();return n&&Array.isArray(n)&&0!==n.length?(0,a.jsx)("div",{ref:t,className:P("flex items-center justify-center gap-4","top"===o?"pb-3":"pt-3",r),children:n.map(e=>{let t=l["".concat(i||e.dataKey||"value")];return(0,a.jsxs)("div",{className:P("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[(null==t?void 0:t.icon)&&!s?(0,a.jsx)(t.icon,{}):(0,a.jsx)("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:e.color}}),(0,a.jsx)("span",{className:"text-muted-foreground",children:(null==t?void 0:t.label)||e.value})]},e.value)})}):null}).displayName="ChartLegendContent";let A={received:{label:"Recibidos",color:"#14b8a6"},sent:{label:"Enviados",color:"#22c55e"}};function W(e){let{data:t=[],loading:r=!1}=e,s=t.reduce((e,t)=>e+t.sent+t.received,0),n=t.slice(-3).reduce((e,t)=>e+t.sent+t.received,0),o=t.slice(-6,-3).reduce((e,t)=>e+t.sent+t.received,0),i=o>0?((n-o)/o*100).toFixed(1):"0",c=parseFloat(i)>=0,d=t.length>0?"".concat(t[0].date," - ").concat(t[t.length-1].date):"\xdaltimos 7 d\xedas";return r?(0,a.jsxs)(y.Zb,{children:[(0,a.jsxs)(y.Ol,{children:[(0,a.jsx)(l.O,{className:"h-6 w-48"}),(0,a.jsx)(l.O,{className:"h-4 w-64 mt-2"})]}),(0,a.jsx)(y.aY,{children:(0,a.jsx)(l.O,{className:"h-[250px] w-full"})}),(0,a.jsx)(y.eW,{children:(0,a.jsx)(l.O,{className:"h-4 w-32"})})]}):(0,a.jsxs)(y.Zb,{children:[(0,a.jsxs)(y.Ol,{children:[(0,a.jsx)(y.ll,{children:"Actividad de Mensajes"}),(0,a.jsx)(y.SZ,{children:"Mensajes enviados y recibidos en los \xfaltimos 7 d\xedas"})]}),(0,a.jsx)(y.aY,{children:(0,a.jsx)(I,{config:A,className:"h-[15rem] w-full",children:(0,a.jsxs)(f.T,{accessibilityLayer:!0,data:t,margin:{left:0,right:0},children:[(0,a.jsx)(b.q,{vertical:!1}),(0,a.jsx)(v.K,{dataKey:"date",tickLine:!1,axisLine:!1,tickMargin:8,tickFormatter:e=>e}),(0,a.jsx)(T,{cursor:!1,content:(0,a.jsx)(_,{})}),(0,a.jsxs)("defs",{children:[(0,a.jsxs)("linearGradient",{id:"fillReceived",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,a.jsx)("stop",{offset:"5%",stopColor:"var(--color-received)",stopOpacity:.8}),(0,a.jsx)("stop",{offset:"95%",stopColor:"var(--color-received)",stopOpacity:.1})]}),(0,a.jsxs)("linearGradient",{id:"fillSent",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,a.jsx)("stop",{offset:"5%",stopColor:"var(--color-sent)",stopOpacity:.8}),(0,a.jsx)("stop",{offset:"95%",stopColor:"var(--color-sent)",stopOpacity:.1})]})]}),(0,a.jsx)(j.uN,{dataKey:"received",type:"natural",fill:"url(#fillReceived)",fillOpacity:.4,stroke:"var(--color-received)",stackId:"a"}),(0,a.jsx)(j.uN,{dataKey:"sent",type:"natural",fill:"url(#fillSent)",fillOpacity:.4,stroke:"var(--color-sent)",stackId:"a"})]})})}),(0,a.jsx)(y.eW,{children:(0,a.jsx)("div",{className:"flex w-full items-start gap-2 text-sm",children:(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)("div",{className:"flex items-center gap-2 leading-none font-medium",children:s>0?(0,a.jsxs)(a.Fragment,{children:[c?"Incremento":"Disminuci\xf3n"," del ",Math.abs(parseFloat(i)),"% en los \xfaltimos 3 d\xedas",c&&(0,a.jsx)(p.Z,{className:"h-4 w-4"})]}):"No hay datos de mensajes a\xfan"}),(0,a.jsx)("div",{className:"text-muted-foreground flex items-center gap-2 leading-none",children:d})]})})})]})}var z=r(92566),B=r(34028);let R={whatsapp:{label:"WhatsApp",color:"#22c55e"},telegram:{label:"Telegram",color:"#14b8a6"},instagram:{label:"Instagram",color:"#f97316"},messenger:{label:"Messenger",color:"#3b82f6"}};function D(e){let{data:t=[],loading:r=!1}=e,s=t.reduce((e,t)=>(e.whatsapp+=t.whatsapp,e.telegram+=t.telegram,e.instagram+=t.instagram,e.messenger+=t.messenger,e),{whatsapp:0,telegram:0,instagram:0,messenger:0}),n=Object.values(s).reduce((e,t)=>e+t,0),o=Object.entries(s).filter(e=>{let[t,r]=e;return r>0}).sort((e,t)=>{let[,r]=e,[,a]=t;return a-r})[0],i=t.length>0?"".concat(t[0].date," - ").concat(t[t.length-1].date):"\xdaltimos 7 d\xedas";return r?(0,a.jsxs)(y.Zb,{children:[(0,a.jsxs)(y.Ol,{children:[(0,a.jsx)(l.O,{className:"h-6 w-48"}),(0,a.jsx)(l.O,{className:"h-4 w-64 mt-2"})]}),(0,a.jsx)(y.aY,{children:(0,a.jsx)(l.O,{className:"h-[250px] w-full"})}),(0,a.jsx)(y.eW,{children:(0,a.jsx)(l.O,{className:"h-4 w-32"})})]}):(0,a.jsxs)(y.Zb,{children:[(0,a.jsxs)(y.Ol,{children:[(0,a.jsx)(y.ll,{children:"Mensajes por Integraci\xf3n"}),(0,a.jsx)(y.SZ,{children:"Mensajes totales por plataforma en los \xfaltimos 7 d\xedas"})]}),(0,a.jsx)(y.aY,{children:(0,a.jsx)(I,{config:R,className:"h-[15rem] w-full",children:(0,a.jsxs)(z.w,{accessibilityLayer:!0,data:t,margin:{left:0,right:0,top:12,bottom:12},children:[(0,a.jsx)(b.q,{vertical:!1,strokeDasharray:"3 3"}),(0,a.jsx)(v.K,{dataKey:"date",tickLine:!1,axisLine:!1,tickMargin:8,tickFormatter:e=>e.slice(0,6)}),(0,a.jsx)(T,{cursor:!1,content:(0,a.jsx)(_,{})}),(0,a.jsx)(B.x,{dataKey:"whatsapp",type:"monotone",stroke:"var(--color-whatsapp)",strokeWidth:2,dot:!1}),(0,a.jsx)(B.x,{dataKey:"telegram",type:"monotone",stroke:"var(--color-telegram)",strokeWidth:2,dot:!1}),(0,a.jsx)(B.x,{dataKey:"instagram",type:"monotone",stroke:"var(--color-instagram)",strokeWidth:2,dot:!1}),(0,a.jsx)(B.x,{dataKey:"messenger",type:"monotone",stroke:"var(--color-messenger)",strokeWidth:2,dot:!1})]})})}),(0,a.jsx)(y.eW,{children:(0,a.jsx)("div",{className:"flex w-full items-start gap-2 text-sm",children:(0,a.jsx)("div",{className:"grid gap-2",children:n>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex items-center gap-2 leading-none font-medium",children:o&&(0,a.jsxs)(a.Fragment,{children:[R[o[0]].label," es la m\xe1s activa con ",o[1]," mensajes",(0,a.jsx)(p.Z,{className:"h-4 w-4"})]})}),(0,a.jsxs)("div",{className:"text-muted-foreground flex items-center gap-2 leading-none",children:[i," • Total: ",n," mensajes"]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-muted-foreground leading-none",children:"No hay mensajes registrados a\xfan"}),(0,a.jsx)("div",{className:"text-muted-foreground text-xs leading-none",children:i})]})})})})]})}var F=r(89733),U=r(49354);function Z(){let{token:e}=(0,o.a)(),[t,r]=(0,s.useState)(null),[a,n]=(0,s.useState)(!0),[l,c]=(0,s.useState)(null),d=async()=>{if(!e){n(!1);return}try{n(!0),c(null);let t=await (0,i.SC)("/usage/conversations",{method:"GET"},e);if(t.success)r(t.data);else throw Error(t.error||"Error desconocido")}catch(e){console.error("Error fetching conversation usage:",e),c(e.message)}finally{n(!1)}};return(0,s.useEffect)(()=>{d()},[e]),{usage:t,loading:a,error:l,refetch:d}}function K(){let{token:e}=(0,o.a)(),[t,r]=(0,s.useState)(!1),[a,n]=(0,s.useState)(null);return{buyAddOn:async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"preventive_dashboard";if(!e)return n("No autorizado"),null;try{r(!0),n(null);let a=await fetch("/api/addons/create-checkout-session",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({quantity:500,source:t})});if(!a.ok)throw Error("Error al crear sesi\xf3n de pago");let s=await a.json();if(s.sessionId&&s.url)return window.location.href=s.url,s;throw Error("Error al procesar el pago")}catch(e){return console.error("Error buying add-on:",e),n(e.message),null}finally{r(!1)}},loading:t,error:a}}function q(){let{usage:e,loading:t,error:r,refetch:s}=Z(),{buyAddOn:n,loading:o}=K(),i=async()=>{await n("preventive_dashboard")&&setTimeout(s,2e3)};if(t)return(0,a.jsxs)("div",{className:"bg-accent-dark border border-neutral-700 rounded-lg p-6 shadow-lg",children:[(0,a.jsx)(l.O,{className:"h-6 w-64 mx-auto mb-4"}),(0,a.jsx)(l.O,{className:"h-8 w-32 mx-auto mb-4"}),(0,a.jsx)(l.O,{className:"h-3 w-full mb-4"}),(0,a.jsx)(l.O,{className:"h-4 w-48 mx-auto mb-6"}),(0,a.jsx)(l.O,{className:"h-10 w-full"})]});if(r||!e)return(0,a.jsxs)("div",{className:"bg-accent-dark border border-red-500/50 rounded-lg p-6 shadow-lg",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-red-400 mb-2 text-center",children:"Error al cargar m\xe9tricas"}),(0,a.jsx)("p",{className:"text-sm text-neutral-400 text-center",children:r}),(0,a.jsx)(F.z,{onClick:s,className:"w-full mt-4 bg-red-500 hover:bg-red-600 text-white",children:"Reintentar"})]});let c=e.monthly.percentage,d=e.monthly.used,u=e.monthly.limit,m=()=>"critical"===e.status?"text-red-400":"warning"===e.status?"text-orange-400":"text-green-400";return(0,a.jsxs)("div",{className:"bg-accent-dark border border-neutral-700 rounded-lg p-6 shadow-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-4",children:["critical"===e.status?(0,a.jsx)("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}):"warning"===e.status?(0,a.jsx)("svg",{className:"w-5 h-5 text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}):(0,a.jsx)("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,a.jsx)("h3",{className:"text-xl font-bold text-accent-cream",children:"Uso de WhatsApp Business"})]}),(0,a.jsxs)("div",{className:"mb-4 text-center",children:[(0,a.jsxs)("p",{className:(0,U.cn)("text-3xl font-bold",m()),children:[d," / ",u]}),(0,a.jsx)("p",{className:"text-sm text-neutral-400",children:"Conversaciones iniciadas en WhatsApp este mes"}),e.monthly.addOnLimit>0&&(0,a.jsxs)("p",{className:"text-xs text-neutral-500 mt-1",children:["(",e.monthly.baseLimit," del plan + ",e.monthly.addOnLimit," adicionales)"]}),(0,a.jsx)("p",{className:"text-xs text-neutral-600 mt-2",children:"Instagram, Messenger y Telegram son gratuitos"})]}),(0,a.jsx)("div",{className:"w-full bg-neutral-700 rounded-full h-3 mb-4",children:(0,a.jsx)("div",{className:"h-3 rounded-full transition-all duration-300 ".concat("critical"===e.status?"bg-red-500":"warning"===e.status?"bg-orange-500":"bg-green-500"),style:{width:"".concat(Math.min(c,100),"%")}})}),(0,a.jsxs)("div",{className:"flex justify-between text-sm text-neutral-400 mb-4",children:[(0,a.jsx)("span",{children:"0"}),(0,a.jsxs)("span",{className:m(),children:[c,"%"]}),(0,a.jsx)("span",{children:u})]}),(0,a.jsxs)("p",{className:"text-sm text-neutral-300 mb-6 text-center",children:["Te quedan ",(0,a.jsx)("strong",{className:m(),children:e.monthly.remaining})," conversaciones iniciadas en WhatsApp."]}),("warning"===e.status||"critical"===e.status)&&(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)(F.z,{onClick:i,className:"bg-orange-500 hover:bg-orange-600 text-white font-semibold py-2 px-6 rounded-lg transition-colors",disabled:o,children:o?"Procesando...":"Comprar Paquete de WhatsApp Adicional"})}),(0,a.jsx)("p",{className:"text-xs text-neutral-500 mt-6 text-center",children:"Recuerda: Las conversaciones de respuesta a clientes activos son ilimitadas y no consumen tu cuota."})]})}var J=r(31721),V=r(13763);function H(e){let{isOpen:t,onClose:r,onUpgradePlan:s}=e,{usage:n,refetch:o}=Z(),{buyAddOn:i,loading:l}=K(),c=async()=>{await i("emergency_modal")&&(setTimeout(o,2e3),r())};if(!n)return null;let d=n.monthly.percentage,u=n.monthly.used,m=n.monthly.limit,x=(()=>{let e=n.monthly.baseLimit;return e<=450?"Crecimiento":e<=1500?"Pro":"Business"})();return(0,a.jsx)(J.M,{children:t&&(0,a.jsx)(V.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 z-[999] flex items-center justify-center p-4",children:(0,a.jsxs)(V.E.div,{initial:{scale:.9,y:50},animate:{scale:1,y:0},exit:{scale:.9,y:50},className:"bg-accent-dark border border-neutral-700 rounded-lg shadow-xl max-w-md w-full p-6 relative",children:[(0,a.jsx)("button",{onClick:r,className:"absolute top-4 right-4 text-neutral-400 hover:text-accent-cream transition-colors",disabled:l,children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-orange-500/20 rounded-full mb-4",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,a.jsx)("h3",{className:"text-2xl font-bold text-accent-cream mb-2",children:"\xa1L\xedmite de WhatsApp Alcanzado!"}),(0,a.jsxs)("p",{className:"text-neutral-300 text-sm",children:["Has usado tu cuota de ",(0,a.jsxs)("strong",{className:"text-orange-400",children:[u," / ",m," Conversaciones Iniciadas en WhatsApp"]})," de este mes."]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("div",{className:"w-full bg-neutral-700 rounded-full h-2",children:(0,a.jsx)("div",{className:"h-2 bg-orange-500 rounded-full transition-all duration-300",style:{width:"".concat(Math.min(d,100),"%")}})}),(0,a.jsxs)("p",{className:"text-xs text-neutral-400 mt-2 text-center",children:[m-u," conversaciones restantes"]})]}),(0,a.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,a.jsx)(F.z,{onClick:c,className:"w-full bg-orange-500 hover:bg-orange-600 text-white font-semibold py-2 rounded-lg transition-colors",disabled:l,children:l?"Procesando...":"Comprar 500 Conversaciones de WhatsApp ($30 USD)"}),"Business"!==x&&(0,a.jsxs)(F.z,{onClick:s,className:"w-full bg-nexly-teal hover:bg-nexly-teal-dark text-accent-cream font-semibold py-2 rounded-lg transition-colors",variant:"outline",disabled:l,children:["Subir a Plan ","Crecimiento"===x?"Pro":"Business"]})]}),(0,a.jsx)("p",{className:"text-xs text-neutral-500 text-center",children:"Recuerda: Las conversaciones de respuesta a clientes activos son ilimitadas y no consumen tu cuota."})]})})})}function G(e){let{id:t,type:r,title:s,description:n,onDismiss:o}=e;return(0,a.jsxs)(V.E.div,{initial:{opacity:0,y:-50,scale:.3},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,scale:.5,transition:{duration:.2}},className:"relative flex items-start p-4 rounded-lg border ".concat((()=>{switch(r){case"success":return"bg-green-500/10 border-green-500/20";case"error":return"bg-red-500/10 border-red-500/20";case"warning":return"bg-orange-500/10 border-orange-500/20";case"info":return"bg-blue-500/10 border-blue-500/20"}})()," shadow-lg max-w-sm w-full"),children:[(0,a.jsx)("div",{className:"flex-shrink-0 mr-3",children:(()=>{switch(r){case"success":return(0,a.jsx)("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})});case"error":return(0,a.jsx)("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})});case"warning":return(0,a.jsx)("svg",{className:"w-5 h-5 text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});case"info":return(0,a.jsx)("svg",{className:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}})()}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-accent-cream",children:s}),n&&(0,a.jsx)("p",{className:"text-sm text-neutral-400 mt-1",children:n})]}),(0,a.jsx)("button",{onClick:()=>o(t),className:"flex-shrink-0 ml-3 text-neutral-400 hover:text-accent-cream transition-colors",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}function Y(){let{toasts:e,dismiss:t}=function(){let[e,t]=(0,s.useState)([]);return{toasts:e,toast:(0,s.useCallback)(e=>{let r=Math.random().toString(36).substr(2,9),a={id:r,duration:5e3,...e};t(e=>[...e,a]),a.duration&&a.duration>0&&setTimeout(()=>{t(e=>e.filter(e=>e.id!==r))},a.duration)},[]),dismiss:(0,s.useCallback)(e=>{t(t=>t.filter(t=>t.id!==e))},[]),dismissAll:(0,s.useCallback)(()=>{t([])},[])}}();return(0,a.jsx)("div",{className:"fixed top-4 right-4 z-[1000] space-y-2",children:(0,a.jsx)(J.M,{children:e.map(e=>(0,a.jsx)(G,{id:e.id,type:e.type,title:e.title,description:e.description,onDismiss:t},e.id))})})}function $(){let{user:e}=(0,o.a)(),t=(0,n.useSearchParams)(),[r,c]=(0,s.useState)(!1),[u,m]=(0,s.useState)(!1),[x,h]=(0,s.useState)(!1),[p,f]=(0,s.useState)(!1),{stats:b,loading:v,error:j}=function(){let[e,t]=(0,s.useState)({activeIntegrations:0,unreadMessages:0}),[r,a]=(0,s.useState)(!0),[n,o]=(0,s.useState)(null);return(0,s.useEffect)(()=>{(async()=>{try{a(!0),o(null),console.log("Fetching stats from /analytics/dashboard...");let e=await (0,i.SC)("/analytics/dashboard");if(e.success)t(e.data);else throw Error(e.error||"Error en la respuesta")}catch(e){console.error("Error fetching stats:",e),o(e.message||"Error al cargar estad\xedsticas"),t({activeIntegrations:0,unreadMessages:0})}finally{a(!1)}})()},[]),{stats:e,loading:r,error:n}}(),{data:y,loading:N}=function(){let[e,t]=(0,s.useState)([]),[r,a]=(0,s.useState)(!0),[n,o]=(0,s.useState)(null),i=async()=>{try{a(!0),o(null);let e=localStorage.getItem("token");if(!e){a(!1),o("No authentication token found");return}let r=await fetch("".concat("https://nexly-production.up.railway.app","/analytics/messages-timeline"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!r.ok)throw Error("Failed to fetch messages timeline");let s=await r.json();s.success&&s.data?(t(s.data),console.log("✅ Using real data from API")):(console.log("\uD83D\uDCCA No data available from API"),t([]))}catch(e){console.error("Error fetching messages timeline:",e),o(e instanceof Error?e.message:"Unknown error"),t([])}finally{a(!1)}};return(0,s.useEffect)(()=>{i()},[]),{data:e,loading:r,error:n,refetch:i}}(),{data:w,loading:k}=function(){let[e,t]=(0,s.useState)([]),[r,a]=(0,s.useState)(!0),[n,o]=(0,s.useState)(null),i=async()=>{try{a(!0),o(null);let e=localStorage.getItem("token");if(!e){a(!1),o("No authentication token found");return}let r=await fetch("".concat("https://nexly-production.up.railway.app","/analytics/messages-by-integration"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!r.ok)throw Error("Failed to fetch messages by integration");let s=await r.json();s.success&&s.data?(t(s.data),console.log("✅ Using real data from API")):(console.log("\uD83D\uDCCA No data available from API"),t([]))}catch(e){console.error("Error fetching messages by integration:",e),o(e instanceof Error?e.message:"Unknown error"),t([])}finally{a(!1)}};return(0,s.useEffect)(()=>{i()},[]),{data:e,loading:r,error:n,refetch:i}}(),{usage:S,loading:C}=Z();return(0,s.useEffect)(()=>{"true"===t.get("trial_started")?(c(!0),setTimeout(()=>c(!1),5e3)):c(!1)},[t]),(0,s.useEffect)(()=>{S&&!S.canSend&&"critical"===S.status&&f(!0)},[S]),(0,s.useEffect)(()=>{"true"===t.get("payment_error")&&(m(!0),setTimeout(()=>m(!1),1e4))},[t]),(0,s.useEffect)(()=>{"true"===t.get("payment_success")&&(h(!0),setTimeout(()=>h(!1),5e3))},[t]),(0,a.jsxs)("div",{className:"h-full flex flex-col text-foreground",style:{background:"var(--background-gradient)"},children:[(0,a.jsx)("div",{className:"border-b border-border bg-background backdrop-blur-sm",children:(0,a.jsx)("div",{className:"px-6 py-4",children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-lg font-medium text-foreground",children:"Dashboard"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-0.5",children:"Overview and metrics"})]})})})}),(0,a.jsxs)("div",{className:"flex-1 p-6 space-y-8",children:[r&&(0,a.jsxs)("div",{className:"bg-success/10 border border-success/20 rounded-lg p-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-success rounded-full"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-foreground",children:"Trial started"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"7 days free access"})]})]}),(0,a.jsx)("button",{onClick:()=>c(!1),className:"text-muted-foreground hover:text-foreground",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u&&(0,a.jsxs)("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-destructive rounded-full"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-foreground",children:"Payment failed"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Please try again"})]})]}),(0,a.jsx)("button",{onClick:()=>m(!1),className:"text-muted-foreground hover:text-foreground",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),x&&(0,a.jsxs)("div",{className:"bg-success/10 border border-success/20 rounded-lg p-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-success rounded-full"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-foreground",children:"Payment successful"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Subscription activated"})]})]}),(0,a.jsx)("button",{onClick:()=>h(!1),className:"text-muted-foreground hover:text-foreground",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsx)(g,{}),(0,a.jsx)(q,{}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:v?Array.from({length:2}).map((e,t)=>(0,a.jsxs)("div",{className:"bg-muted/50 border border-border rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsx)(l.O,{className:"h-3 w-20"}),(0,a.jsx)(l.O,{className:"h-8 w-12"})]}),(0,a.jsx)(l.O,{className:"w-8 h-8 rounded-md"})]}),(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)(l.O,{className:"h-3 w-24"})})]},t)):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d,{title:"Integrations",value:b.activeIntegrations,subtitle:b.activeIntegrations>0?void 0:"Sin integraciones activas",color:"blue",icon:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),trend:b.activeIntegrations>0?{value:2,label:"this month",isPositive:!0}:void 0}),(0,a.jsx)(d,{title:"Mensajes Sin Leer",value:b.unreadMessages,subtitle:b.unreadMessages>0?void 0:"Todo al d\xeda",color:"red",icon:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),trend:b.unreadMessages>0?{value:b.unreadMessages,label:"pendientes",isPositive:!1}:void 0})]})}),(0,a.jsx)(W,{data:y,loading:N}),(0,a.jsx)(D,{data:w,loading:k}),(0,a.jsxs)("div",{className:"bg-muted/30 border border-border rounded-lg p-6",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-foreground mb-4",children:"Quick Actions"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("button",{onClick:()=>window.location.href="/dashboard/contacts",className:"bg-accent-green/10 border border-accent-green/20 hover:bg-accent-green/20 text-accent-green p-4 rounded-lg flex items-center gap-3 transition-colors",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"font-medium text-sm",children:"View Contacts"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Manage contacts"})]})]}),(0,a.jsxs)("button",{onClick:()=>window.location.href="/dashboard/integrations",className:"bg-accent-blue/10 border border-accent-blue/20 hover:bg-accent-blue/20 text-accent-blue p-4 rounded-lg flex items-center gap-3 transition-colors",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"font-medium text-sm",children:"Connect App"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Integrate platform"})]})]}),(0,a.jsxs)("button",{onClick:()=>window.location.href="/dashboard/inbox",className:"bg-accent-cream/10 border border-accent-cream/20 hover:bg-accent-cream/20 text-accent-cream p-4 rounded-lg flex items-center gap-3 transition-colors",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:"font-medium text-sm",children:"View Inbox"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Manage conversations"})]})]})]})]}),(0,a.jsx)(H,{isOpen:p,onClose:()=>f(!1),onUpgradePlan:()=>{f(!1),window.location.href="/pricing"}}),(0,a.jsx)(Y,{})]})]})}},89733:(e,t,r)=>{"use strict";r.d(t,{d:()=>o,z:()=>i});var a=r(57437),s=r(2265),n=r(44839);let o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.W)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{"bg-primary text-primary-foreground hover:bg-primary/90":"default"===e.variant||!e.variant,"bg-destructive text-destructive-foreground hover:bg-destructive/90":"destructive"===e.variant,"border border-input bg-background hover:bg-accent hover:text-accent-foreground":"outline"===e.variant,"bg-secondary text-secondary-foreground hover:bg-secondary/80":"secondary"===e.variant,"hover:bg-accent hover:text-accent-foreground":"ghost"===e.variant,"text-primary underline-offset-4 hover:underline":"link"===e.variant},{"h-10 px-4 py-2":!0})},i=s.forwardRef((e,t)=>{let{className:r,variant:s="default",size:o="default",children:i,...l}=e;return(0,a.jsx)("button",{className:(0,n.W)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{"bg-primary text-primary-foreground hover:bg-primary/90":"default"===s,"bg-destructive text-destructive-foreground hover:bg-destructive/90":"destructive"===s,"border border-input bg-background hover:bg-accent hover:text-accent-foreground":"outline"===s,"bg-secondary text-secondary-foreground hover:bg-secondary/80":"secondary"===s,"hover:bg-accent hover:text-accent-foreground":"ghost"===s,"text-primary underline-offset-4 hover:underline":"link"===s},{"h-10 px-4 py-2":"default"===o,"h-9 rounded-md px-3":"sm"===o,"h-11 rounded-md px-8":"lg"===o,"h-10 w-10":"icon"===o},r),ref:t,...l,children:i})});i.displayName="Button"},48185:(e,t,r)=>{"use strict";r.d(t,{Ol:()=>i,SZ:()=>c,Zb:()=>o,aY:()=>d,eW:()=>u,ll:()=>l});var a=r(57437),s=r(2265),n=r(44839);let o=s.forwardRef((e,t)=>{let{className:r,children:s,...o}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.W)("rounded-lg border bg-card text-card-foreground shadow-sm h-fit sm:h-auto",r),...o,children:s})});o.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:r,children:s,...o}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.W)("flex flex-col space-y-1.5 p-6",r),...o,children:s})});i.displayName="CardHeader";let l=s.forwardRef((e,t)=>{let{className:r,children:s,...o}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.W)("text-2xl font-semibold leading-none tracking-tight",r),...o,children:s})});l.displayName="CardTitle";let c=s.forwardRef((e,t)=>{let{className:r,children:s,...o}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.W)("text-sm text-muted-foreground",r),...o,children:s})});c.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:r,children:s,...o}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.W)("p-6 pt-0",r),...o,children:s})});d.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:r,children:s,...o}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.W)("flex items-center p-6 pt-0",r),...o,children:s})});u.displayName="CardFooter"},2183:(e,t,r)=>{"use strict";r.d(t,{O:()=>n});var a=r(57437),s=r(44839);function n(e){let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,s.Z)("animate-pulse rounded-md bg-neutral-700",t),...r})}},12104:(e,t,r)=>{"use strict";r.d(t,{f4:()=>c,mU:()=>l,qR:()=>i});var a=r(57437),s=r(2265),n=r(67048);let o=(0,s.createContext)(void 0);function i(e){let{children:t}=e,{token:r}=(0,n.a)(),[i,l]=(0,s.useState)(null),[c,d]=(0,s.useState)(!0),[u,m]=(0,s.useState)(null),x=(0,s.useCallback)(async()=>{if(!r){d(!1);return}try{var e;d(!0),m(null),console.log("\uD83D\uDD04 Fetching subscription status...");let t=await fetch("".concat("https://nexly-production.up.railway.app","/subscriptions/status?t=").concat(Date.now()),{headers:{Authorization:"Bearer ".concat(r),"Cache-Control":"no-cache"}});if(!t.ok)throw Error("Error ".concat(t.status,": ").concat(t.statusText));let a=await t.json();console.log("\uD83D\uDCCA Subscription data received:",a),l(a),a.hasSubscription&&(null===(e=a.subscription)||void 0===e?void 0:e.planType)?(localStorage.setItem("selectedPlan",a.subscription.planType),localStorage.setItem("hasActiveSubscription","true")):(localStorage.removeItem("selectedPlan"),localStorage.removeItem("hasActiveSubscription"))}catch(e){console.error("❌ Error fetching subscription:",e),l({hasSubscription:!1}),m(e instanceof Error?e.message:"Error desconocido"),localStorage.removeItem("hasActiveSubscription")}finally{d(!1)}},[r]);(0,s.useEffect)(()=>{l(null),m(null),d(!0),r?x():d(!1)},[r,x]);let h=(0,s.useMemo)(()=>{var e;if(!i)return{isPaid:!1,isTrial:!1,isFree:!0,active:!1,trialActive:!1,pendingPaymentMethod:!1,paused:!1,cancelled:!1,pastDue:!1,incomplete:!1};let t=i.hasSubscription,r=i.userSubscriptionStatus,a=null===(e=i.subscription)||void 0===e?void 0:e.status,s="active_paid"===r||"active"===a,n="active_trial"===r||"trialing"===a;return{isPaid:!!s,isTrial:!!n,isFree:!(s||n)||!t,active:!!s,trialActive:!!n,pendingPaymentMethod:"trial_pending_payment_method"===r,paused:"paused"===a,cancelled:"canceled"===a,pastDue:"past_due"===a,incomplete:!!("incomplete"===a||"incomplete_expired"===a)}},[i]),g=(0,s.useCallback)(e=>{var t,r;if(!(null==i?void 0:i.hasSubscription))return!1;let a=null===(t=i.subscription)||void 0===t?void 0:t.planType;return!!a&&((null===(r=({crecimiento:["whatsapp","instagram","telegram"],pro:["whatsapp","instagram","messenger","telegram"],business:["whatsapp","instagram","messenger","telegram","tiktok","twitter"]})[a])||void 0===r?void 0:r.includes(e))||!1)},[i]),p=(0,s.useCallback)(()=>{var e;if(!(null==i?void 0:i.hasSubscription))return 0;switch(null===(e=i.subscription)||void 0===e?void 0:e.planType){case"crecimiento":return 3;case"pro":return 4;case"business":return 999;default:return 0}},[i]),f=(0,s.useCallback)(e=>{var t;l(e),m(null),e.hasSubscription&&(null===(t=e.subscription)||void 0===t?void 0:t.planType)&&(localStorage.setItem("selectedPlan",e.subscription.planType),localStorage.setItem("hasActiveSubscription","true"))},[]),b=(0,s.useCallback)(async()=>{console.log("\uD83D\uDD04 Forcing subscription context refresh..."),await x()},[x]),v=(0,s.useMemo)(()=>({subscription:i,loading:c,error:u,status:h,refetch:x,canUseFeature:g,getMaxIntegrations:p,updateAfterPayment:f,forceRefresh:b}),[i,c,u,h,x,g,p,f,b]);return(0,a.jsx)(o.Provider,{value:v,children:t})}function l(){let e=(0,s.useContext)(o);if(void 0===e)throw Error("useSubscription must be used within a SubscriptionProvider");return e}function c(){return(0,s.useContext)(o)}},67048:(e,t,r)=>{"use strict";r.d(t,{a:()=>s});var a=r(2265);function s(){let[e,t]=(0,a.useState)(null),[r,s]=(0,a.useState)(null),[n,o]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=localStorage.getItem("token"),r=localStorage.getItem("user");if(e&&r)try{let a=JSON.parse(r);s(e),t(a)}catch(e){localStorage.removeItem("token"),localStorage.removeItem("user")}o(!1)},[]),{user:e,token:r,setAuth:(e,r)=>{s(e),t(r),localStorage.setItem("token",e),localStorage.setItem("user",JSON.stringify(r))},clear:()=>{s(null),t(null),localStorage.removeItem("token"),localStorage.removeItem("user")},logout:()=>{console.log("\uD83D\uDD04 Logout manual iniciado..."),localStorage.removeItem("token"),localStorage.removeItem("user"),document.cookie="token=; Path=/; Max-Age=0; SameSite=Lax",sessionStorage.clear(),window.location.replace("/login")},isLoading:n,isAuthenticated:!!r&&!!e}}},64673:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(2265),s=r(12104);function n(){let[e,t]=(0,a.useState)(!1),r=(0,s.f4)(),n=null==r?void 0:r.subscription;return{createPaymentLink:async e=>{t(!0);try{var r;let t=localStorage.getItem("token");if(!t)return alert("No est\xe1s autenticado"),!1;let a=e||(null==n?void 0:null===(r=n.subscription)||void 0===r?void 0:r.planType),s=await fetch("".concat("https://nexly-production.up.railway.app","/subscriptions/create-payment-link"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({...a&&{planType:a}})}),o=await s.json();if(o.success&&o.paymentUrl)return window.location.href=o.paymentUrl,!0;if(console.error("Error creating payment link:",o.error),429===s.status)return alert("Demasiados intentos de pago. Intenta nuevamente en 15 minutos."),!1;return alert(o.error||"Error al crear el enlace de pago"),!1}catch(e){return console.error("Error creating payment link:",e),(null==e?void 0:e.name)==="TypeError"||((null==e?void 0:e.message)||"").includes("fetch")?alert("Error de conexi\xf3n. Verifica tu internet e intenta nuevamente."):alert("Error inesperado al crear el enlace de pago"),!1}finally{t(!1)}},loading:e,canCreatePayment:(null==n?void 0:n.userSubscriptionStatus)==="trial_pending_payment_method"}}},92800:(e,t,r)=>{"use strict";r.d(t,{SC:()=>n,T5:()=>a,ZP:()=>u,aS:()=>l,oJ:()=>d,qL:()=>o,qi:()=>c,x4:()=>i});let a="https://nexly-production.up.railway.app".replace(/\/+$/,""),s=e=>"".concat(a).concat(e.startsWith("/")?e:"/".concat(e));async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,a=r||function(){if("undefined"==typeof document)return;let e=document.cookie.match(/(?:^|;\s*)token=([^;]+)/);return e?decodeURIComponent(e[1]):void 0}(),n=await fetch(s(e),{...t,headers:{"Content-Type":"application/json",...a?{Authorization:"Bearer ".concat(a)}:{},...t.headers||{}}});if(!n.ok){if(401===n.status)throw console.warn("\uD83D\uDD12 Token expirado detectado en:",e),console.warn("\uD83D\uDCC5 Timestamp:",new Date().toISOString()),localStorage.removeItem("token"),localStorage.removeItem("user"),document.cookie="token=; Path=/; Max-Age=0; SameSite=Lax",sessionStorage.clear(),console.warn("\uD83D\uDE80 Ejecutando logout autom\xe1tico..."),window.location.replace("/login"),Error("Sesi\xf3n expirada. Redirigiendo al login...");let t="HTTP ".concat(n.status);try{let e=await n.json();t=(null==e?void 0:e.message)||(null==e?void 0:e.error)||t}catch(e){}throw Error(t)}if(204!==n.status)return await n.json()}function o(e){return n("/auth/register",{method:"POST",body:JSON.stringify(e)})}function i(e){return n("/contacts/sync",{method:"POST"},e)}function l(e,t){return n("/contacts/sync/provider/".concat(e),{method:"POST"},t)}function c(e,t){let r=localStorage.getItem("token");return n("/ai/analyze",{method:"POST",headers:{"Content-Type":"application/json",...r&&{Authorization:"Bearer ".concat(r)}},body:JSON.stringify({message:e,context:t})})}function d(e,t){let r=localStorage.getItem("token");return n("/ai/generate-response",{method:"POST",headers:{"Content-Type":"application/json",...r&&{Authorization:"Bearer ".concat(r)}},body:JSON.stringify({message:e,businessContext:t})})}let u=n},49354:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var a=r(44839),s=r(96164);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,a.W)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[4868,6235,7776,4842,7130,6215,1744],()=>t(2063)),_N_E=e.O()}]);