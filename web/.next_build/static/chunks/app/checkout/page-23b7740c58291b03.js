(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[285],{53750:(e,t,a)=>{Promise.resolve().then(a.bind(a,29593))},16463:(e,t,a)=>{"use strict";var n=a(71169);a.o(n,"usePathname")&&a.d(t,{usePathname:function(){return n.usePathname}}),a.o(n,"useRouter")&&a.d(t,{useRouter:function(){return n.useRouter}}),a.o(n,"useSearchParams")&&a.d(t,{useSearchParams:function(){return n.useSearchParams}})},29593:(e,t,a)=>{"use strict";a.d(t,{default:()=>i});var n=a(57437),s=a(2265),r=a(16463),l=a(67048),o=a(70640),c=a(61575);function i(){let e=(0,r.useSearchParams)(),t=(0,r.useRouter)(),{setAuth:a}=(0,l.a)(),[i,d]=(0,s.useState)(!0),[u,m]=(0,s.useState)(""),x=e.get("plan"),h=e.get("payment")||"stripe",g=e.get("token");return((0,s.useEffect)(()=>{let e=async()=>{try{if(g){localStorage.setItem("token",g),document.cookie="token=".concat(g,"; Path=/; SameSite=Lax");let e=await fetch("".concat("https://nexly-production.up.railway.app","/auth/me"),{headers:{Authorization:"Bearer ".concat(g)}});if(e.ok){let t=await e.json();a(g,t.user)}}let e=await fetch("".concat("https://nexly-production.up.railway.app").concat("stripe"===h?"/stripe/create-payment-link":"/subscriptions/create-payment-link"),{method:"POST",headers:{Authorization:"Bearer ".concat(g),"Content-Type":"application/json"},body:JSON.stringify({planType:x})}),t=await e.json();if(t.success&&t.paymentUrl)window.location.href=t.paymentUrl;else{let e=t.error||t.message||"Error desconocido";m("Error al crear el enlace de pago: "+e)}}catch(e){console.error("Error en checkout:",e),m("Error al procesar el pago: "+e.message)}finally{d(!1)}};x&&g?e():(m("Faltan par\xe1metros requeridos para el checkout"),d(!1))},[x,h,g,a]),i)?(0,n.jsxs)("div",{className:"w-full max-w-md text-center",children:[(0,n.jsx)("div",{className:"flex justify-center mb-6",children:(0,n.jsx)(o.Z,{size:"md"})}),(0,n.jsx)("div",{className:"rounded-2xl",children:(0,n.jsx)(c.ZP,{size:"xl",text:"Redirigiendo a Stripe para completar tu suscripci\xf3n"})})]}):u?(0,n.jsxs)("div",{className:"w-full max-w-md text-center",children:[(0,n.jsx)("div",{className:"flex justify-center mb-6",children:(0,n.jsx)(o.Z,{size:"md"})}),(0,n.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[(0,n.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,n.jsx)("span",{className:"text-2xl text-red-600",children:"⚠️"})}),(0,n.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error en el pago"}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:u}),(0,n.jsx)("button",{onClick:()=>t.push("/pricing"),className:"bg-nexly-teal hover:bg-nexly-green text-accent-cream font-semibold px-6 py-3 rounded-lg transition-colors duration-300",children:"Volver a Planes"})]})]}):null}},61575:(e,t,a)=>{"use strict";a.d(t,{ZP:()=>r});var n=a(57437),s=a(66648);function r(e){let{size:t="md",text:a,fullScreen:r=!1,className:l=""}=e,o={sm:"w-8 h-8",md:"w-12 h-12",lg:"w-16 h-16",xl:"w-24 h-24"},c={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8",xl:"w-12 h-12"},i={sm:"border-2",md:"border-[3px]",lg:"border-4",xl:"border-[5px]"},d=()=>(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 ".concat(l),children:[(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"\n            ".concat(o[t]," \n            ").concat(i[t],"\n            rounded-full \n            border-transparent\n            border-t-nexly-green \n            border-r-nexly-teal\n            animate-spin\n            shadow-nexly-green/30\n          "),style:{animationDuration:"1s",animationTimingFunction:"linear"}}),(0,n.jsx)("div",{className:"\n          ".concat(o[t]," \n          rounded-full \n          absolute top-0 left-0 \n          flex items-center justify-center\n          bg-gradient-to-br from-nexly-green/10 to-nexly-teal/10\n        "),children:(0,n.jsx)(s.default,{src:"/logo_single.png",alt:"Nexly",width:48,height:48,className:"".concat(c[t]," object-contain animate-pulse"),priority:!0})})]}),a&&(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("p",{className:"text-accent-cream font-medium text-sm tracking-wide mb-2",children:a}),(0,n.jsxs)("div",{className:"flex items-center justify-center gap-1.5",children:[(0,n.jsx)("div",{className:"w-1.5 h-1.5 bg-nexly-green rounded-full animate-bounce shadow-lg shadow-nexly-green/50"}),(0,n.jsx)("div",{className:"w-1.5 h-1.5 bg-nexly-teal rounded-full animate-bounce shadow-lg shadow-nexly-teal/50",style:{animationDelay:"0.15s"}}),(0,n.jsx)("div",{className:"w-1.5 h-1.5 bg-nexly-green rounded-full animate-bounce shadow-lg shadow-nexly-green/50",style:{animationDelay:"0.3s"}})]})]})]});return r?(0,n.jsx)("div",{className:"fixed inset-0 bg-gradient-to-br from-neutral-900 via-neutral-800 to-neutral-900 backdrop-blur-sm z-50 flex items-center justify-center",children:(0,n.jsx)(d,{})}):(0,n.jsx)(d,{})}},70640:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var n=a(57437),s=a(87138);function r(e){let{href:t="/",className:a="",showText:r=!1,textClassName:l="text-xl font-bold",size:o="md"}=e,c=(0,n.jsxs)("div",{className:"flex items-center gap-3 ".concat(a),children:[(0,n.jsx)("div",{className:"".concat({sm:"w-24",md:"w-32",lg:"w-40"}[o]," flex items-center justify-center"),children:(0,n.jsx)("img",{src:"/logo_nexly.png",alt:"Nexly Logo",className:"w-full h-full object-contain"})}),r&&(0,n.jsx)("span",{className:"".concat(l),children:"Nexly"})]});return t?(0,n.jsx)(s.default,{href:t,className:"inline-block hover:opacity-80 transition-opacity duration-300",children:c}):c}},67048:(e,t,a)=>{"use strict";a.d(t,{a:()=>s});var n=a(2265);function s(){let[e,t]=(0,n.useState)(null),[a,s]=(0,n.useState)(null),[r,l]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{let e=localStorage.getItem("token"),a=localStorage.getItem("user");if(e&&a)try{let n=JSON.parse(a);s(e),t(n)}catch(e){localStorage.removeItem("token"),localStorage.removeItem("user")}l(!1)},[]),{user:e,token:a,setAuth:(e,a)=>{s(e),t(a),localStorage.setItem("token",e),localStorage.setItem("user",JSON.stringify(a))},clear:()=>{s(null),t(null),localStorage.removeItem("token"),localStorage.removeItem("user")},logout:()=>{console.log("\uD83D\uDD04 Logout manual iniciado..."),localStorage.removeItem("token"),localStorage.removeItem("user"),document.cookie="token=; Path=/; Max-Age=0; SameSite=Lax",sessionStorage.clear(),window.location.replace("/login")},isLoading:r,isAuthenticated:!!a&&!!e}}}},e=>{var t=t=>e(e.s=t);e.O(0,[7138,6648,7130,6215,1744],()=>t(53750)),_N_E=e.O()}]);